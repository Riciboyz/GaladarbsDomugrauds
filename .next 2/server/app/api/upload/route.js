"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/upload/route";
exports.ids = ["app/api/upload/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "sqlite3":
/*!**************************!*\
  !*** external "sqlite3" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("sqlite3");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "fs/promises":
/*!******************************!*\
  !*** external "fs/promises" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("fs/promises");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fupload%2Froute&page=%2Fapi%2Fupload%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fupload%2Froute.ts&appDir=%2FUsers%2Friciboy%2FDesktop%2Fgaladarbinsskola%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Friciboy%2FDesktop%2Fgaladarbinsskola&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fupload%2Froute&page=%2Fapi%2Fupload%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fupload%2Froute.ts&appDir=%2FUsers%2Friciboy%2FDesktop%2Fgaladarbinsskola%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Friciboy%2FDesktop%2Fgaladarbinsskola&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_riciboy_Desktop_galadarbinsskola_app_api_upload_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/upload/route.ts */ \"(rsc)/./app/api/upload/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/upload/route\",\n        pathname: \"/api/upload\",\n        filename: \"route\",\n        bundlePath: \"app/api/upload/route\"\n    },\n    resolvedPagePath: \"/Users/riciboy/Desktop/galadarbinsskola/app/api/upload/route.ts\",\n    nextConfigOutput,\n    userland: _Users_riciboy_Desktop_galadarbinsskola_app_api_upload_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/upload/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZ1cGxvYWQlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRnVwbG9hZCUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRnVwbG9hZCUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRnJpY2lib3klMkZEZXNrdG9wJTJGZ2FsYWRhcmJpbnNza29sYSUyRmFwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9JTJGVXNlcnMlMkZyaWNpYm95JTJGRGVza3RvcCUyRmdhbGFkYXJiaW5zc2tvbGEmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQ2U7QUFDNUY7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBaUU7QUFDekU7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUN1SDs7QUFFdkgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90aHJlYWRzLWFwcC1iZWV0Lz81ZjkwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi9Vc2Vycy9yaWNpYm95L0Rlc2t0b3AvZ2FsYWRhcmJpbnNza29sYS9hcHAvYXBpL3VwbG9hZC9yb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvdXBsb2FkL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvdXBsb2FkXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS91cGxvYWQvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCIvVXNlcnMvcmljaWJveS9EZXNrdG9wL2dhbGFkYXJiaW5zc2tvbGEvYXBwL2FwaS91cGxvYWQvcm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL3VwbG9hZC9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fupload%2Froute&page=%2Fapi%2Fupload%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fupload%2Froute.ts&appDir=%2FUsers%2Friciboy%2FDesktop%2Fgaladarbinsskola%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Friciboy%2FDesktop%2Fgaladarbinsskola&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/auth/db.js":
/*!****************************!*\
  !*** ./app/api/auth/db.js ***!
  \****************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

eval("\nconst db = __webpack_require__(/*! ../../../database/db */ \"(rsc)/./database/db.js\");\nconst bcrypt = __webpack_require__(/*! bcryptjs */ \"(rsc)/./node_modules/bcryptjs/index.js\");\nconst jwt = __webpack_require__(/*! jsonwebtoken */ \"(rsc)/./node_modules/jsonwebtoken/index.js\");\nconst crypto = __webpack_require__(/*! crypto */ \"crypto\");\n// JWT configuration\nconst JWT_SECRET = process.env.JWT_SECRET || \"your-super-secret-jwt-key\";\nconst JWT_EXPIRES_IN = process.env.JWT_EXPIRES_IN || \"7d\";\n// User authentication functions\nconst createUser = async (userData)=>{\n    const { username, displayName, email, password, avatar, bio } = userData;\n    try {\n        // Check if user already exists\n        const existingUser = await getUserByEmail(email);\n        if (existingUser) {\n            throw new Error(\"User with this email already exists\");\n        }\n        const existingUsername = await getUserByUsername(username);\n        if (existingUsername) {\n            throw new Error(\"Username already taken\");\n        }\n        // Hash password\n        const passwordHash = await bcrypt.hash(password, 12);\n        const userId = crypto.randomUUID();\n        // Create user\n        const result = await db.query(`\n      INSERT INTO users (id, username, display_name, email, password_hash, avatar, bio)\n      VALUES (?, ?, ?, ?, ?, ?, ?)\n    `, [\n            userId,\n            username,\n            displayName,\n            email,\n            passwordHash,\n            avatar || null,\n            bio || null\n        ]);\n        // Return user without password\n        const newUser = await getUserById(userId);\n        return newUser;\n    } catch (error) {\n        console.error(\"Error creating user:\", error);\n        throw error;\n    }\n};\nconst getUserByEmail = async (email)=>{\n    try {\n        const result = await db.get(\"SELECT * FROM users WHERE email = ?\", [\n            email\n        ]);\n        return result.rows[0] || null;\n    } catch (error) {\n        console.error(\"Error getting user by email:\", error);\n        throw error;\n    }\n};\nconst getUserByUsername = async (username)=>{\n    try {\n        const result = await db.get(\"SELECT * FROM users WHERE username = ?\", [\n            username\n        ]);\n        return result.rows[0] || null;\n    } catch (error) {\n        console.error(\"Error getting user by username:\", error);\n        throw error;\n    }\n};\nconst getUserById = async (id)=>{\n    try {\n        const result = await db.get(\"SELECT * FROM users WHERE id = ?\", [\n            id\n        ]);\n        return result.rows[0] || null;\n    } catch (error) {\n        console.error(\"Error getting user by ID:\", error);\n        throw error;\n    }\n};\nconst getAllUsers = async ()=>{\n    try {\n        const result = await db.query(`\n      SELECT \n        id, username, display_name, email, avatar, bio, \n        created_at, following, followers\n      FROM users\n      ORDER BY created_at DESC\n    `);\n        return result.rows;\n    } catch (error) {\n        console.error(\"Error getting all users:\", error);\n        throw error;\n    }\n};\nconst updateUser = async (id, updateData)=>{\n    try {\n        const { username, displayName, email, avatar, bio, following, followers } = updateData;\n        // Check if username is taken by another user\n        if (username) {\n            const existingUser = await getUserByUsername(username);\n            if (existingUser && existingUser.id !== id) {\n                throw new Error(\"Username already taken\");\n            }\n        }\n        // Check if email is taken by another user\n        if (email) {\n            const existingUser = await getUserByEmail(email);\n            if (existingUser && existingUser.id !== id) {\n                throw new Error(\"Email already taken\");\n            }\n        }\n        await db.query(`\n      UPDATE users \n      SET username = COALESCE(?, username),\n          display_name = COALESCE(?, display_name),\n          email = COALESCE(?, email),\n          avatar = COALESCE(?, avatar),\n          bio = COALESCE(?, bio),\n          following = COALESCE(?, following),\n          followers = COALESCE(?, followers),\n          updated_at = CURRENT_TIMESTAMP\n      WHERE id = ?\n    `, [\n            username,\n            displayName,\n            email,\n            avatar,\n            bio,\n            following,\n            followers,\n            id\n        ]);\n        return await getUserById(id);\n    } catch (error) {\n        console.error(\"Error updating user:\", error);\n        throw error;\n    }\n};\nconst deleteUser = async (id)=>{\n    try {\n        await db.query(\"DELETE FROM users WHERE id = ?\", [\n            id\n        ]);\n        await db.query(\"DELETE FROM user_sessions WHERE user_id = ?\", [\n            id\n        ]);\n        return true;\n    } catch (error) {\n        console.error(\"Error deleting user:\", error);\n        throw error;\n    }\n};\nconst verifyUserPassword = async (email, password)=>{\n    try {\n        const user = await getUserByEmail(email);\n        if (!user) {\n            return null;\n        }\n        const isValid = await bcrypt.compare(password, user.password_hash);\n        return isValid ? user : null;\n    } catch (error) {\n        console.error(\"Error verifying password:\", error);\n        throw error;\n    }\n};\n// JWT token functions\nconst generateToken = (user)=>{\n    const payload = {\n        id: user.id,\n        email: user.email,\n        username: user.username\n    };\n    return jwt.sign(payload, JWT_SECRET, {\n        expiresIn: JWT_EXPIRES_IN\n    });\n};\nconst verifyToken = (token)=>{\n    try {\n        return jwt.verify(token, JWT_SECRET);\n    } catch (error) {\n        return null;\n    }\n};\n// Session management\nconst createSession = async (userId, token, ipAddress, userAgent)=>{\n    try {\n        const sessionId = crypto.randomUUID();\n        const expiresAt = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000); // 7 days\n        await db.query(`\n      INSERT INTO user_sessions (id, user_id, session_token, expires_at)\n      VALUES (?, ?, ?, ?)\n    `, [\n            sessionId,\n            userId,\n            token,\n            expiresAt.toISOString()\n        ]);\n        return sessionId;\n    } catch (error) {\n        console.error(\"Error creating session:\", error);\n        throw error;\n    }\n};\nconst getSession = async (token)=>{\n    try {\n        const result = await db.get(`\n      SELECT s.*, u.id as user_id, u.username, u.display_name, u.email, u.avatar, u.bio\n      FROM user_sessions s\n      JOIN users u ON s.user_id = u.id\n      WHERE s.session_token = ? AND s.expires_at > datetime('now')\n    `, [\n            token\n        ]);\n        return result.rows[0] || null;\n    } catch (error) {\n        console.error(\"Error getting session:\", error);\n        throw error;\n    }\n};\nconst deleteSession = async (token)=>{\n    try {\n        await db.query(\"DELETE FROM user_sessions WHERE session_token = ?\", [\n            token\n        ]);\n        return true;\n    } catch (error) {\n        console.error(\"Error deleting session:\", error);\n        throw error;\n    }\n};\nconst deleteAllUserSessions = async (userId)=>{\n    try {\n        await db.query(\"DELETE FROM user_sessions WHERE user_id = ?\", [\n            userId\n        ]);\n        return true;\n    } catch (error) {\n        console.error(\"Error deleting user sessions:\", error);\n        throw error;\n    }\n};\nmodule.exports = {\n    createUser,\n    getUserByEmail,\n    getUserByUsername,\n    getUserById,\n    getAllUsers,\n    updateUser,\n    deleteUser,\n    verifyUserPassword,\n    generateToken,\n    verifyToken,\n    createSession,\n    getSession,\n    deleteSession,\n    deleteAllUserSessions\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUMsRUFBRTtZQUFDbUI7U0FBTTtRQUVWLE9BQU96QixPQUFPTyxJQUFJLENBQUMsRUFBRSxJQUFJO0lBQzNCLEVBQUUsT0FBT0gsT0FBTztRQUNkQyxRQUFRRCxLQUFLLENBQUMsMEJBQTBCQTtRQUN4QyxNQUFNQTtJQUNSO0FBQ0Y7QUFFQSxNQUFNZ0MsZ0JBQWdCLE9BQU9YO0lBQzNCLElBQUk7UUFDRixNQUFNbkQsR0FBRzJCLEtBQUssQ0FBQyxxREFBcUQ7WUFBQ3dCO1NBQU07UUFDM0UsT0FBTztJQUNULEVBQUUsT0FBT3JCLE9BQU87UUFDZEMsUUFBUUQsS0FBSyxDQUFDLDJCQUEyQkE7UUFDekMsTUFBTUE7SUFDUjtBQUNGO0FBRUEsTUFBTWlDLHdCQUF3QixPQUFPdkM7SUFDbkMsSUFBSTtRQUNGLE1BQU14QixHQUFHMkIsS0FBSyxDQUFDLCtDQUErQztZQUFDSDtTQUFPO1FBQ3RFLE9BQU87SUFDVCxFQUFFLE9BQU9NLE9BQU87UUFDZEMsUUFBUUQsS0FBSyxDQUFDLGlDQUFpQ0E7UUFDL0MsTUFBTUE7SUFDUjtBQUNGO0FBRUFrQyxPQUFPQyxPQUFPLEdBQUc7SUFDZnhEO0lBQ0FTO0lBQ0FHO0lBQ0FRO0lBQ0FNO0lBQ0FDO0lBQ0FJO0lBQ0FDO0lBQ0FLO0lBQ0FJO0lBQ0FHO0lBQ0FRO0lBQ0FDO0lBQ0FDO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90aHJlYWRzLWFwcC1iZWV0Ly4vYXBwL2FwaS9hdXRoL2RiLmpzP2I4NzMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZGIgPSByZXF1aXJlKCcuLi8uLi8uLi9kYXRhYmFzZS9kYicpO1xuY29uc3QgYmNyeXB0ID0gcmVxdWlyZSgnYmNyeXB0anMnKTtcbmNvbnN0IGp3dCA9IHJlcXVpcmUoJ2pzb253ZWJ0b2tlbicpO1xuY29uc3QgY3J5cHRvID0gcmVxdWlyZSgnY3J5cHRvJyk7XG5cbi8vIEpXVCBjb25maWd1cmF0aW9uXG5jb25zdCBKV1RfU0VDUkVUID0gcHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCB8fCAneW91ci1zdXBlci1zZWNyZXQtand0LWtleSc7XG5jb25zdCBKV1RfRVhQSVJFU19JTiA9IHByb2Nlc3MuZW52LkpXVF9FWFBJUkVTX0lOIHx8ICc3ZCc7XG5cbi8vIFVzZXIgYXV0aGVudGljYXRpb24gZnVuY3Rpb25zXG5jb25zdCBjcmVhdGVVc2VyID0gYXN5bmMgKHVzZXJEYXRhKSA9PiB7XG4gIGNvbnN0IHsgdXNlcm5hbWUsIGRpc3BsYXlOYW1lLCBlbWFpbCwgcGFzc3dvcmQsIGF2YXRhciwgYmlvIH0gPSB1c2VyRGF0YTtcbiAgXG4gIHRyeSB7XG4gICAgLy8gQ2hlY2sgaWYgdXNlciBhbHJlYWR5IGV4aXN0c1xuICAgIGNvbnN0IGV4aXN0aW5nVXNlciA9IGF3YWl0IGdldFVzZXJCeUVtYWlsKGVtYWlsKTtcbiAgICBpZiAoZXhpc3RpbmdVc2VyKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1VzZXIgd2l0aCB0aGlzIGVtYWlsIGFscmVhZHkgZXhpc3RzJyk7XG4gICAgfVxuICAgIFxuICAgIGNvbnN0IGV4aXN0aW5nVXNlcm5hbWUgPSBhd2FpdCBnZXRVc2VyQnlVc2VybmFtZSh1c2VybmFtZSk7XG4gICAgaWYgKGV4aXN0aW5nVXNlcm5hbWUpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignVXNlcm5hbWUgYWxyZWFkeSB0YWtlbicpO1xuICAgIH1cbiAgICBcbiAgICAvLyBIYXNoIHBhc3N3b3JkXG4gICAgY29uc3QgcGFzc3dvcmRIYXNoID0gYXdhaXQgYmNyeXB0Lmhhc2gocGFzc3dvcmQsIDEyKTtcbiAgICBjb25zdCB1c2VySWQgPSBjcnlwdG8ucmFuZG9tVVVJRCgpO1xuICAgIFxuICAgIC8vIENyZWF0ZSB1c2VyXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIucXVlcnkoYFxuICAgICAgSU5TRVJUIElOVE8gdXNlcnMgKGlkLCB1c2VybmFtZSwgZGlzcGxheV9uYW1lLCBlbWFpbCwgcGFzc3dvcmRfaGFzaCwgYXZhdGFyLCBiaW8pXG4gICAgICBWQUxVRVMgKD8sID8sID8sID8sID8sID8sID8pXG4gICAgYCwgW3VzZXJJZCwgdXNlcm5hbWUsIGRpc3BsYXlOYW1lLCBlbWFpbCwgcGFzc3dvcmRIYXNoLCBhdmF0YXIgfHwgbnVsbCwgYmlvIHx8IG51bGxdKTtcbiAgICBcbiAgICAvLyBSZXR1cm4gdXNlciB3aXRob3V0IHBhc3N3b3JkXG4gICAgY29uc3QgbmV3VXNlciA9IGF3YWl0IGdldFVzZXJCeUlkKHVzZXJJZCk7XG4gICAgcmV0dXJuIG5ld1VzZXI7XG4gICAgXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgdXNlcjonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn07XG5cbmNvbnN0IGdldFVzZXJCeUVtYWlsID0gYXN5bmMgKGVtYWlsKSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuZ2V0KCdTRUxFQ1QgKiBGUk9NIHVzZXJzIFdIRVJFIGVtYWlsID0gPycsIFtlbWFpbF0pO1xuICAgIHJldHVybiByZXN1bHQucm93c1swXSB8fCBudWxsO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdldHRpbmcgdXNlciBieSBlbWFpbDonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn07XG5cbmNvbnN0IGdldFVzZXJCeVVzZXJuYW1lID0gYXN5bmMgKHVzZXJuYW1lKSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuZ2V0KCdTRUxFQ1QgKiBGUk9NIHVzZXJzIFdIRVJFIHVzZXJuYW1lID0gPycsIFt1c2VybmFtZV0pO1xuICAgIHJldHVybiByZXN1bHQucm93c1swXSB8fCBudWxsO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdldHRpbmcgdXNlciBieSB1c2VybmFtZTonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn07XG5cbmNvbnN0IGdldFVzZXJCeUlkID0gYXN5bmMgKGlkKSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuZ2V0KCdTRUxFQ1QgKiBGUk9NIHVzZXJzIFdIRVJFIGlkID0gPycsIFtpZF0pO1xuICAgIHJldHVybiByZXN1bHQucm93c1swXSB8fCBudWxsO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdldHRpbmcgdXNlciBieSBJRDonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn07XG5cbmNvbnN0IGdldEFsbFVzZXJzID0gYXN5bmMgKCkgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLnF1ZXJ5KGBcbiAgICAgIFNFTEVDVCBcbiAgICAgICAgaWQsIHVzZXJuYW1lLCBkaXNwbGF5X25hbWUsIGVtYWlsLCBhdmF0YXIsIGJpbywgXG4gICAgICAgIGNyZWF0ZWRfYXQsIGZvbGxvd2luZywgZm9sbG93ZXJzXG4gICAgICBGUk9NIHVzZXJzXG4gICAgICBPUkRFUiBCWSBjcmVhdGVkX2F0IERFU0NcbiAgICBgKTtcbiAgICByZXR1cm4gcmVzdWx0LnJvd3M7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZ2V0dGluZyBhbGwgdXNlcnM6JywgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xuICB9XG59O1xuXG5jb25zdCB1cGRhdGVVc2VyID0gYXN5bmMgKGlkLCB1cGRhdGVEYXRhKSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgeyB1c2VybmFtZSwgZGlzcGxheU5hbWUsIGVtYWlsLCBhdmF0YXIsIGJpbywgZm9sbG93aW5nLCBmb2xsb3dlcnMgfSA9IHVwZGF0ZURhdGE7XG4gICAgXG4gICAgLy8gQ2hlY2sgaWYgdXNlcm5hbWUgaXMgdGFrZW4gYnkgYW5vdGhlciB1c2VyXG4gICAgaWYgKHVzZXJuYW1lKSB7XG4gICAgICBjb25zdCBleGlzdGluZ1VzZXIgPSBhd2FpdCBnZXRVc2VyQnlVc2VybmFtZSh1c2VybmFtZSk7XG4gICAgICBpZiAoZXhpc3RpbmdVc2VyICYmIGV4aXN0aW5nVXNlci5pZCAhPT0gaWQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdVc2VybmFtZSBhbHJlYWR5IHRha2VuJyk7XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8vIENoZWNrIGlmIGVtYWlsIGlzIHRha2VuIGJ5IGFub3RoZXIgdXNlclxuICAgIGlmIChlbWFpbCkge1xuICAgICAgY29uc3QgZXhpc3RpbmdVc2VyID0gYXdhaXQgZ2V0VXNlckJ5RW1haWwoZW1haWwpO1xuICAgICAgaWYgKGV4aXN0aW5nVXNlciAmJiBleGlzdGluZ1VzZXIuaWQgIT09IGlkKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignRW1haWwgYWxyZWFkeSB0YWtlbicpO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICBhd2FpdCBkYi5xdWVyeShgXG4gICAgICBVUERBVEUgdXNlcnMgXG4gICAgICBTRVQgdXNlcm5hbWUgPSBDT0FMRVNDRSg/LCB1c2VybmFtZSksXG4gICAgICAgICAgZGlzcGxheV9uYW1lID0gQ09BTEVTQ0UoPywgZGlzcGxheV9uYW1lKSxcbiAgICAgICAgICBlbWFpbCA9IENPQUxFU0NFKD8sIGVtYWlsKSxcbiAgICAgICAgICBhdmF0YXIgPSBDT0FMRVNDRSg/LCBhdmF0YXIpLFxuICAgICAgICAgIGJpbyA9IENPQUxFU0NFKD8sIGJpbyksXG4gICAgICAgICAgZm9sbG93aW5nID0gQ09BTEVTQ0UoPywgZm9sbG93aW5nKSxcbiAgICAgICAgICBmb2xsb3dlcnMgPSBDT0FMRVNDRSg/LCBmb2xsb3dlcnMpLFxuICAgICAgICAgIHVwZGF0ZWRfYXQgPSBDVVJSRU5UX1RJTUVTVEFNUFxuICAgICAgV0hFUkUgaWQgPSA/XG4gICAgYCwgW3VzZXJuYW1lLCBkaXNwbGF5TmFtZSwgZW1haWwsIGF2YXRhciwgYmlvLCBmb2xsb3dpbmcsIGZvbGxvd2VycywgaWRdKTtcbiAgICBcbiAgICByZXR1cm4gYXdhaXQgZ2V0VXNlckJ5SWQoaWQpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIHVzZXI6JywgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xuICB9XG59O1xuXG5jb25zdCBkZWxldGVVc2VyID0gYXN5bmMgKGlkKSA9PiB7XG4gIHRyeSB7XG4gICAgYXdhaXQgZGIucXVlcnkoJ0RFTEVURSBGUk9NIHVzZXJzIFdIRVJFIGlkID0gPycsIFtpZF0pO1xuICAgIGF3YWl0IGRiLnF1ZXJ5KCdERUxFVEUgRlJPTSB1c2VyX3Nlc3Npb25zIFdIRVJFIHVzZXJfaWQgPSA/JywgW2lkXSk7XG4gICAgcmV0dXJuIHRydWU7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVsZXRpbmcgdXNlcjonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn07XG5cbmNvbnN0IHZlcmlmeVVzZXJQYXNzd29yZCA9IGFzeW5jIChlbWFpbCwgcGFzc3dvcmQpID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCB1c2VyID0gYXdhaXQgZ2V0VXNlckJ5RW1haWwoZW1haWwpO1xuICAgIGlmICghdXNlcikge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIFxuICAgIGNvbnN0IGlzVmFsaWQgPSBhd2FpdCBiY3J5cHQuY29tcGFyZShwYXNzd29yZCwgdXNlci5wYXNzd29yZF9oYXNoKTtcbiAgICByZXR1cm4gaXNWYWxpZCA/IHVzZXIgOiBudWxsO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHZlcmlmeWluZyBwYXNzd29yZDonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn07XG5cbi8vIEpXVCB0b2tlbiBmdW5jdGlvbnNcbmNvbnN0IGdlbmVyYXRlVG9rZW4gPSAodXNlcikgPT4ge1xuICBjb25zdCBwYXlsb2FkID0ge1xuICAgIGlkOiB1c2VyLmlkLFxuICAgIGVtYWlsOiB1c2VyLmVtYWlsLFxuICAgIHVzZXJuYW1lOiB1c2VyLnVzZXJuYW1lXG4gIH07XG4gIFxuICByZXR1cm4gand0LnNpZ24ocGF5bG9hZCwgSldUX1NFQ1JFVCwgeyBleHBpcmVzSW46IEpXVF9FWFBJUkVTX0lOIH0pO1xufTtcblxuY29uc3QgdmVyaWZ5VG9rZW4gPSAodG9rZW4pID0+IHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gand0LnZlcmlmeSh0b2tlbiwgSldUX1NFQ1JFVCk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn07XG5cbi8vIFNlc3Npb24gbWFuYWdlbWVudFxuY29uc3QgY3JlYXRlU2Vzc2lvbiA9IGFzeW5jICh1c2VySWQsIHRva2VuLCBpcEFkZHJlc3MsIHVzZXJBZ2VudCkgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHNlc3Npb25JZCA9IGNyeXB0by5yYW5kb21VVUlEKCk7XG4gICAgY29uc3QgZXhwaXJlc0F0ID0gbmV3IERhdGUoRGF0ZS5ub3coKSArIDcgKiAyNCAqIDYwICogNjAgKiAxMDAwKTsgLy8gNyBkYXlzXG4gICAgXG4gICAgYXdhaXQgZGIucXVlcnkoYFxuICAgICAgSU5TRVJUIElOVE8gdXNlcl9zZXNzaW9ucyAoaWQsIHVzZXJfaWQsIHNlc3Npb25fdG9rZW4sIGV4cGlyZXNfYXQpXG4gICAgICBWQUxVRVMgKD8sID8sID8sID8pXG4gICAgYCwgW3Nlc3Npb25JZCwgdXNlcklkLCB0b2tlbiwgZXhwaXJlc0F0LnRvSVNPU3RyaW5nKCldKTtcbiAgICBcbiAgICByZXR1cm4gc2Vzc2lvbklkO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIHNlc3Npb246JywgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xuICB9XG59O1xuXG5jb25zdCBnZXRTZXNzaW9uID0gYXN5bmMgKHRva2VuKSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuZ2V0KGBcbiAgICAgIFNFTEVDVCBzLiosIHUuaWQgYXMgdXNlcl9pZCwgdS51c2VybmFtZSwgdS5kaXNwbGF5X25hbWUsIHUuZW1haWwsIHUuYXZhdGFyLCB1LmJpb1xuICAgICAgRlJPTSB1c2VyX3Nlc3Npb25zIHNcbiAgICAgIEpPSU4gdXNlcnMgdSBPTiBzLnVzZXJfaWQgPSB1LmlkXG4gICAgICBXSEVSRSBzLnNlc3Npb25fdG9rZW4gPSA/IEFORCBzLmV4cGlyZXNfYXQgPiBkYXRldGltZSgnbm93JylcbiAgICBgLCBbdG9rZW5dKTtcbiAgICBcbiAgICByZXR1cm4gcmVzdWx0LnJvd3NbMF0gfHwgbnVsbDtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZXR0aW5nIHNlc3Npb246JywgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xuICB9XG59O1xuXG5jb25zdCBkZWxldGVTZXNzaW9uID0gYXN5bmMgKHRva2VuKSA9PiB7XG4gIHRyeSB7XG4gICAgYXdhaXQgZGIucXVlcnkoJ0RFTEVURSBGUk9NIHVzZXJfc2Vzc2lvbnMgV0hFUkUgc2Vzc2lvbl90b2tlbiA9ID8nLCBbdG9rZW5dKTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBzZXNzaW9uOicsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxufTtcblxuY29uc3QgZGVsZXRlQWxsVXNlclNlc3Npb25zID0gYXN5bmMgKHVzZXJJZCkgPT4ge1xuICB0cnkge1xuICAgIGF3YWl0IGRiLnF1ZXJ5KCdERUxFVEUgRlJPTSB1c2VyX3Nlc3Npb25zIFdIRVJFIHVzZXJfaWQgPSA/JywgW3VzZXJJZF0pO1xuICAgIHJldHVybiB0cnVlO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIHVzZXIgc2Vzc2lvbnM6JywgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xuICB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgY3JlYXRlVXNlcixcbiAgZ2V0VXNlckJ5RW1haWwsXG4gIGdldFVzZXJCeVVzZXJuYW1lLFxuICBnZXRVc2VyQnlJZCxcbiAgZ2V0QWxsVXNlcnMsXG4gIHVwZGF0ZVVzZXIsXG4gIGRlbGV0ZVVzZXIsXG4gIHZlcmlmeVVzZXJQYXNzd29yZCxcbiAgZ2VuZXJhdGVUb2tlbixcbiAgdmVyaWZ5VG9rZW4sXG4gIGNyZWF0ZVNlc3Npb24sXG4gIGdldFNlc3Npb24sXG4gIGRlbGV0ZVNlc3Npb24sXG4gIGRlbGV0ZUFsbFVzZXJTZXNzaW9uc1xufTtcbiJdLCJuYW1lcyI6WyJkYiIsInJlcXVpcmUiLCJiY3J5cHQiLCJqd3QiLCJjcnlwdG8iLCJKV1RfU0VDUkVUIiwicHJvY2VzcyIsImVudiIsIkpXVF9FWFBJUkVTX0lOIiwiY3JlYXRlVXNlciIsInVzZXJEYXRhIiwidXNlcm5hbWUiLCJkaXNwbGF5TmFtZSIsImVtYWlsIiwicGFzc3dvcmQiLCJhdmF0YXIiLCJiaW8iLCJleGlzdGluZ1VzZXIiLCJnZXRVc2VyQnlFbWFpbCIsIkVycm9yIiwiZXhpc3RpbmdVc2VybmFtZSIsImdldFVzZXJCeVVzZXJuYW1lIiwicGFzc3dvcmRIYXNoIiwiaGFzaCIsInVzZXJJZCIsInJhbmRvbVVVSUQiLCJyZXN1bHQiLCJxdWVyeSIsIm5ld1VzZXIiLCJnZXRVc2VyQnlJZCIsImVycm9yIiwiY29uc29sZSIsImdldCIsInJvd3MiLCJpZCIsImdldEFsbFVzZXJzIiwidXBkYXRlVXNlciIsInVwZGF0ZURhdGEiLCJmb2xsb3dpbmciLCJmb2xsb3dlcnMiLCJkZWxldGVVc2VyIiwidmVyaWZ5VXNlclBhc3N3b3JkIiwidXNlciIsImlzVmFsaWQiLCJjb21wYXJlIiwicGFzc3dvcmRfaGFzaCIsImdlbmVyYXRlVG9rZW4iLCJwYXlsb2FkIiwic2lnbiIsImV4cGlyZXNJbiIsInZlcmlmeVRva2VuIiwidG9rZW4iLCJ2ZXJpZnkiLCJjcmVhdGVTZXNzaW9uIiwiaXBBZGRyZXNzIiwidXNlckFnZW50Iiwic2Vzc2lvbklkIiwiZXhwaXJlc0F0IiwiRGF0ZSIsIm5vdyIsInRvSVNPU3RyaW5nIiwiZ2V0U2Vzc2lvbiIsImRlbGV0ZVNlc3Npb24iLCJkZWxldGVBbGxVc2VyU2Vzc2lvbnMiLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/auth/db.js\n");

/***/ }),

/***/ "(rsc)/./app/api/upload/route.ts":
/*!*********************************!*\
  !*** ./app/api/upload/route.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var fs_promises__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! fs/promises */ \"fs/promises\");\n/* harmony import */ var fs_promises__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(fs_promises__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_3__);\n\n\n\n\nconst authDb = __webpack_require__(/*! ../auth/db */ \"(rsc)/./app/api/auth/db.js\");\nasync function POST(request) {\n    try {\n        // Check authentication\n        const authToken = request.cookies.get(\"auth-token\")?.value;\n        if (!authToken) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"Authentication required\"\n            }, {\n                status: 401\n            });\n        }\n        // Verify token\n        const decoded = authDb.verifyToken(authToken);\n        if (!decoded) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"Invalid or expired token\"\n            }, {\n                status: 401\n            });\n        }\n        const formData = await request.formData();\n        const file = formData.get(\"file\");\n        if (!file) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"No file provided\"\n            }, {\n                status: 400\n            });\n        }\n        // Validate file type\n        if (!file.type.startsWith(\"image/\")) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"File must be an image\"\n            }, {\n                status: 400\n            });\n        }\n        // Validate file size (max 5MB)\n        if (file.size > 5 * 1024 * 1024) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"File size must be less than 5MB\"\n            }, {\n                status: 400\n            });\n        }\n        // Create uploads directory if it doesn't exist\n        const uploadsDir = (0,path__WEBPACK_IMPORTED_MODULE_2__.join)(process.cwd(), \"public\", \"uploads\", \"avatars\");\n        if (!(0,fs__WEBPACK_IMPORTED_MODULE_3__.existsSync)(uploadsDir)) {\n            await (0,fs_promises__WEBPACK_IMPORTED_MODULE_1__.mkdir)(uploadsDir, {\n                recursive: true\n            });\n        }\n        // Generate unique filename\n        const timestamp = Date.now();\n        const randomString = Math.random().toString(36).substring(2, 15);\n        const fileExtension = file.name.split(\".\").pop() || \"jpg\";\n        const filename = `avatar_${timestamp}_${randomString}.${fileExtension}`;\n        const filepath = (0,path__WEBPACK_IMPORTED_MODULE_2__.join)(uploadsDir, filename);\n        // Convert file to buffer and save\n        const bytes = await file.arrayBuffer();\n        const buffer = Buffer.from(bytes);\n        await (0,fs_promises__WEBPACK_IMPORTED_MODULE_1__.writeFile)(filepath, buffer);\n        // Return the public URL\n        const publicUrl = `/uploads/avatars/${filename}`;\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            url: publicUrl,\n            filename: filename\n        });\n    } catch (error) {\n        console.error(\"Error uploading file:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: \"Failed to upload file\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL3VwbG9hZC9yb3V0ZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUF3RDtBQUNUO0FBQ25CO0FBQ0k7QUFDaEMsTUFBTUssU0FBU0MsbUJBQU9BLENBQUM7QUFFaEIsZUFBZUMsS0FBS0MsT0FBb0I7SUFDN0MsSUFBSTtRQUNGLHVCQUF1QjtRQUN2QixNQUFNQyxZQUFZRCxRQUFRRSxPQUFPLENBQUNDLEdBQUcsQ0FBQyxlQUFlQztRQUNyRCxJQUFJLENBQUNILFdBQVc7WUFDZCxPQUFPVCxxREFBWUEsQ0FBQ2EsSUFBSSxDQUN0QjtnQkFBRUMsU0FBUztnQkFBT0MsT0FBTztZQUEwQixHQUNuRDtnQkFBRUMsUUFBUTtZQUFJO1FBRWxCO1FBRUEsZUFBZTtRQUNmLE1BQU1DLFVBQVVaLE9BQU9hLFdBQVcsQ0FBQ1Q7UUFDbkMsSUFBSSxDQUFDUSxTQUFTO1lBQ1osT0FBT2pCLHFEQUFZQSxDQUFDYSxJQUFJLENBQ3RCO2dCQUFFQyxTQUFTO2dCQUFPQyxPQUFPO1lBQTJCLEdBQ3BEO2dCQUFFQyxRQUFRO1lBQUk7UUFFbEI7UUFFQSxNQUFNRyxXQUFXLE1BQU1YLFFBQVFXLFFBQVE7UUFDdkMsTUFBTUMsT0FBT0QsU0FBU1IsR0FBRyxDQUFDO1FBRTFCLElBQUksQ0FBQ1MsTUFBTTtZQUNULE9BQU9wQixxREFBWUEsQ0FBQ2EsSUFBSSxDQUN0QjtnQkFBRUMsU0FBUztnQkFBT0MsT0FBTztZQUFtQixHQUM1QztnQkFBRUMsUUFBUTtZQUFJO1FBRWxCO1FBRUEscUJBQXFCO1FBQ3JCLElBQUksQ0FBQ0ksS0FBS0MsSUFBSSxDQUFDQyxVQUFVLENBQUMsV0FBVztZQUNuQyxPQUFPdEIscURBQVlBLENBQUNhLElBQUksQ0FDdEI7Z0JBQUVDLFNBQVM7Z0JBQU9DLE9BQU87WUFBd0IsR0FDakQ7Z0JBQUVDLFFBQVE7WUFBSTtRQUVsQjtRQUVBLCtCQUErQjtRQUMvQixJQUFJSSxLQUFLRyxJQUFJLEdBQUcsSUFBSSxPQUFPLE1BQU07WUFDL0IsT0FBT3ZCLHFEQUFZQSxDQUFDYSxJQUFJLENBQ3RCO2dCQUFFQyxTQUFTO2dCQUFPQyxPQUFPO1lBQWtDLEdBQzNEO2dCQUFFQyxRQUFRO1lBQUk7UUFFbEI7UUFFQSwrQ0FBK0M7UUFDL0MsTUFBTVEsYUFBYXJCLDBDQUFJQSxDQUFDc0IsUUFBUUMsR0FBRyxJQUFJLFVBQVUsV0FBVztRQUM1RCxJQUFJLENBQUN0Qiw4Q0FBVUEsQ0FBQ29CLGFBQWE7WUFDM0IsTUFBTXRCLGtEQUFLQSxDQUFDc0IsWUFBWTtnQkFBRUcsV0FBVztZQUFLO1FBQzVDO1FBRUEsMkJBQTJCO1FBQzNCLE1BQU1DLFlBQVlDLEtBQUtDLEdBQUc7UUFDMUIsTUFBTUMsZUFBZUMsS0FBS0MsTUFBTSxHQUFHQyxRQUFRLENBQUMsSUFBSUMsU0FBUyxDQUFDLEdBQUc7UUFDN0QsTUFBTUMsZ0JBQWdCaEIsS0FBS2lCLElBQUksQ0FBQ0MsS0FBSyxDQUFDLEtBQUtDLEdBQUcsTUFBTTtRQUNwRCxNQUFNQyxXQUFXLENBQUMsT0FBTyxFQUFFWixVQUFVLENBQUMsRUFBRUcsYUFBYSxDQUFDLEVBQUVLLGNBQWMsQ0FBQztRQUN2RSxNQUFNSyxXQUFXdEMsMENBQUlBLENBQUNxQixZQUFZZ0I7UUFFbEMsa0NBQWtDO1FBQ2xDLE1BQU1FLFFBQVEsTUFBTXRCLEtBQUt1QixXQUFXO1FBQ3BDLE1BQU1DLFNBQVNDLE9BQU9DLElBQUksQ0FBQ0o7UUFDM0IsTUFBTXpDLHNEQUFTQSxDQUFDd0MsVUFBVUc7UUFFMUIsd0JBQXdCO1FBQ3hCLE1BQU1HLFlBQVksQ0FBQyxpQkFBaUIsRUFBRVAsU0FBUyxDQUFDO1FBRWhELE9BQU94QyxxREFBWUEsQ0FBQ2EsSUFBSSxDQUFDO1lBQ3ZCQyxTQUFTO1lBQ1RrQyxLQUFLRDtZQUNMUCxVQUFVQTtRQUNaO0lBRUYsRUFBRSxPQUFPekIsT0FBTztRQUNka0MsUUFBUWxDLEtBQUssQ0FBQyx5QkFBeUJBO1FBQ3ZDLE9BQU9mLHFEQUFZQSxDQUFDYSxJQUFJLENBQ3RCO1lBQUVDLFNBQVM7WUFBT0MsT0FBTztRQUF3QixHQUNqRDtZQUFFQyxRQUFRO1FBQUk7SUFFbEI7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3RocmVhZHMtYXBwLWJlZXQvLi9hcHAvYXBpL3VwbG9hZC9yb3V0ZS50cz9hODhkIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcic7XG5pbXBvcnQgeyB3cml0ZUZpbGUsIG1rZGlyIH0gZnJvbSAnZnMvcHJvbWlzZXMnO1xuaW1wb3J0IHsgam9pbiB9IGZyb20gJ3BhdGgnO1xuaW1wb3J0IHsgZXhpc3RzU3luYyB9IGZyb20gJ2ZzJztcbmNvbnN0IGF1dGhEYiA9IHJlcXVpcmUoJy4uL2F1dGgvZGInKTtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcbiAgdHJ5IHtcbiAgICAvLyBDaGVjayBhdXRoZW50aWNhdGlvblxuICAgIGNvbnN0IGF1dGhUb2tlbiA9IHJlcXVlc3QuY29va2llcy5nZXQoJ2F1dGgtdG9rZW4nKT8udmFsdWU7XG4gICAgaWYgKCFhdXRoVG9rZW4pIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdBdXRoZW50aWNhdGlvbiByZXF1aXJlZCcgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMSB9XG4gICAgICApO1xuICAgIH1cblxuICAgIC8vIFZlcmlmeSB0b2tlblxuICAgIGNvbnN0IGRlY29kZWQgPSBhdXRoRGIudmVyaWZ5VG9rZW4oYXV0aFRva2VuKTtcbiAgICBpZiAoIWRlY29kZWQpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdJbnZhbGlkIG9yIGV4cGlyZWQgdG9rZW4nIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDEgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgICBjb25zdCBmb3JtRGF0YSA9IGF3YWl0IHJlcXVlc3QuZm9ybURhdGEoKTtcbiAgICBjb25zdCBmaWxlID0gZm9ybURhdGEuZ2V0KCdmaWxlJykgYXMgRmlsZTtcbiAgICBcbiAgICBpZiAoIWZpbGUpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdObyBmaWxlIHByb3ZpZGVkJyB9LFxuICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgICk7XG4gICAgfVxuXG4gICAgLy8gVmFsaWRhdGUgZmlsZSB0eXBlXG4gICAgaWYgKCFmaWxlLnR5cGUuc3RhcnRzV2l0aCgnaW1hZ2UvJykpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdGaWxlIG11c3QgYmUgYW4gaW1hZ2UnIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgICAvLyBWYWxpZGF0ZSBmaWxlIHNpemUgKG1heCA1TUIpXG4gICAgaWYgKGZpbGUuc2l6ZSA+IDUgKiAxMDI0ICogMTAyNCkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0ZpbGUgc2l6ZSBtdXN0IGJlIGxlc3MgdGhhbiA1TUInIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgICAvLyBDcmVhdGUgdXBsb2FkcyBkaXJlY3RvcnkgaWYgaXQgZG9lc24ndCBleGlzdFxuICAgIGNvbnN0IHVwbG9hZHNEaXIgPSBqb2luKHByb2Nlc3MuY3dkKCksICdwdWJsaWMnLCAndXBsb2FkcycsICdhdmF0YXJzJyk7XG4gICAgaWYgKCFleGlzdHNTeW5jKHVwbG9hZHNEaXIpKSB7XG4gICAgICBhd2FpdCBta2Rpcih1cGxvYWRzRGlyLCB7IHJlY3Vyc2l2ZTogdHJ1ZSB9KTtcbiAgICB9XG5cbiAgICAvLyBHZW5lcmF0ZSB1bmlxdWUgZmlsZW5hbWVcbiAgICBjb25zdCB0aW1lc3RhbXAgPSBEYXRlLm5vdygpO1xuICAgIGNvbnN0IHJhbmRvbVN0cmluZyA9IE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cmluZygyLCAxNSk7XG4gICAgY29uc3QgZmlsZUV4dGVuc2lvbiA9IGZpbGUubmFtZS5zcGxpdCgnLicpLnBvcCgpIHx8ICdqcGcnO1xuICAgIGNvbnN0IGZpbGVuYW1lID0gYGF2YXRhcl8ke3RpbWVzdGFtcH1fJHtyYW5kb21TdHJpbmd9LiR7ZmlsZUV4dGVuc2lvbn1gO1xuICAgIGNvbnN0IGZpbGVwYXRoID0gam9pbih1cGxvYWRzRGlyLCBmaWxlbmFtZSk7XG5cbiAgICAvLyBDb252ZXJ0IGZpbGUgdG8gYnVmZmVyIGFuZCBzYXZlXG4gICAgY29uc3QgYnl0ZXMgPSBhd2FpdCBmaWxlLmFycmF5QnVmZmVyKCk7XG4gICAgY29uc3QgYnVmZmVyID0gQnVmZmVyLmZyb20oYnl0ZXMpO1xuICAgIGF3YWl0IHdyaXRlRmlsZShmaWxlcGF0aCwgYnVmZmVyKTtcblxuICAgIC8vIFJldHVybiB0aGUgcHVibGljIFVSTFxuICAgIGNvbnN0IHB1YmxpY1VybCA9IGAvdXBsb2Fkcy9hdmF0YXJzLyR7ZmlsZW5hbWV9YDtcblxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgdXJsOiBwdWJsaWNVcmwsXG4gICAgICBmaWxlbmFtZTogZmlsZW5hbWVcbiAgICB9KTtcblxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwbG9hZGluZyBmaWxlOicsIGVycm9yKTtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0ZhaWxlZCB0byB1cGxvYWQgZmlsZScgfSxcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgICk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJ3cml0ZUZpbGUiLCJta2RpciIsImpvaW4iLCJleGlzdHNTeW5jIiwiYXV0aERiIiwicmVxdWlyZSIsIlBPU1QiLCJyZXF1ZXN0IiwiYXV0aFRva2VuIiwiY29va2llcyIsImdldCIsInZhbHVlIiwianNvbiIsInN1Y2Nlc3MiLCJlcnJvciIsInN0YXR1cyIsImRlY29kZWQiLCJ2ZXJpZnlUb2tlbiIsImZvcm1EYXRhIiwiZmlsZSIsInR5cGUiLCJzdGFydHNXaXRoIiwic2l6ZSIsInVwbG9hZHNEaXIiLCJwcm9jZXNzIiwiY3dkIiwicmVjdXJzaXZlIiwidGltZXN0YW1wIiwiRGF0ZSIsIm5vdyIsInJhbmRvbVN0cmluZyIsIk1hdGgiLCJyYW5kb20iLCJ0b1N0cmluZyIsInN1YnN0cmluZyIsImZpbGVFeHRlbnNpb24iLCJuYW1lIiwic3BsaXQiLCJwb3AiLCJmaWxlbmFtZSIsImZpbGVwYXRoIiwiYnl0ZXMiLCJhcnJheUJ1ZmZlciIsImJ1ZmZlciIsIkJ1ZmZlciIsImZyb20iLCJwdWJsaWNVcmwiLCJ1cmwiLCJjb25zb2xlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/upload/route.ts\n");

/***/ }),

/***/ "(rsc)/./database/db.js":
/*!************************!*\
  !*** ./database/db.js ***!
  \************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

eval("// Simplified database configuration for SQLite\n\nconst sqlite3 = (__webpack_require__(/*! sqlite3 */ \"sqlite3\").verbose)();\nconst path = __webpack_require__(/*! path */ \"path\");\n// Create database file in project root\nconst dbPath = path.join(process.cwd(), \"threads_app.db\");\n// Create database connection\nlet db = null;\nconst initDatabase = ()=>{\n    if (db) return db;\n    db = new sqlite3.Database(dbPath, (err)=>{\n        if (err) {\n            console.error(\"❌ Error opening database:\", err.message);\n        } else {\n            console.log(\"✅ Connected to SQLite database\");\n        }\n    });\n    // Enable foreign keys\n    db.run(\"PRAGMA foreign_keys = ON\");\n    return db;\n};\n// Database helper functions\nconst database = {\n    // Initialize database connection\n    init: ()=>{\n        return initDatabase();\n    },\n    // Execute a query\n    query: (sql, params = [])=>{\n        const db = initDatabase();\n        return new Promise((resolve, reject)=>{\n            if (sql.trim().toUpperCase().startsWith(\"SELECT\")) {\n                db.all(sql, params, (err, rows)=>{\n                    if (err) {\n                        console.error(\"❌ Database query error:\", err);\n                        reject(err);\n                    } else {\n                        resolve({\n                            success: true,\n                            rows\n                        });\n                    }\n                });\n            } else {\n                db.run(sql, params, function(err) {\n                    if (err) {\n                        console.error(\"❌ Database query error:\", err);\n                        reject(err);\n                    } else {\n                        resolve({\n                            success: true,\n                            rowCount: this.changes,\n                            lastID: this.lastID,\n                            rows: this.lastID ? [\n                                {\n                                    id: this.lastID\n                                }\n                            ] : []\n                        });\n                    }\n                });\n            }\n        });\n    },\n    // Get a single row\n    get: (sql, params = [])=>{\n        const db = initDatabase();\n        return new Promise((resolve, reject)=>{\n            db.get(sql, params, (err, row)=>{\n                if (err) {\n                    console.error(\"❌ Database query error:\", err);\n                    reject(err);\n                } else {\n                    resolve({\n                        success: true,\n                        rows: row ? [\n                            row\n                        ] : []\n                    });\n                }\n            });\n        });\n    },\n    // Close database connection\n    close: ()=>{\n        if (db) {\n            return new Promise((resolve)=>{\n                db.close((err)=>{\n                    if (err) {\n                        console.error(\"❌ Error closing database:\", err.message);\n                    } else {\n                        console.log(\"✅ Database connection closed\");\n                    }\n                    db = null;\n                    resolve();\n                });\n            });\n        }\n        return Promise.resolve();\n    },\n    // Transaction helper\n    transaction: async (callback)=>{\n        const db = initDatabase();\n        try {\n            await database.query(\"BEGIN TRANSACTION\");\n            const result = await callback(database);\n            await database.query(\"COMMIT\");\n            return result;\n        } catch (error) {\n            await database.query(\"ROLLBACK\");\n            throw error;\n        }\n    }\n};\nmodule.exports = database;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QixNQUFNL0IsS0FBS0M7UUFDWCxJQUFJO1lBQ0YsTUFBTVEsU0FBU0UsS0FBSyxDQUFDO1lBQ3JCLE1BQU1xQixTQUFTLE1BQU1ELFNBQVN0QjtZQUM5QixNQUFNQSxTQUFTRSxLQUFLLENBQUM7WUFDckIsT0FBT3FCO1FBQ1QsRUFBRSxPQUFPM0IsT0FBTztZQUNkLE1BQU1JLFNBQVNFLEtBQUssQ0FBQztZQUNyQixNQUFNTjtRQUNSO0lBQ0Y7QUFDRjtBQUVBNEIsT0FBT0MsT0FBTyxHQUFHekIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90aHJlYWRzLWFwcC1iZWV0Ly4vZGF0YWJhc2UvZGIuanM/NjRhNCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBTaW1wbGlmaWVkIGRhdGFiYXNlIGNvbmZpZ3VyYXRpb24gZm9yIFNRTGl0ZVxuY29uc3Qgc3FsaXRlMyA9IHJlcXVpcmUoJ3NxbGl0ZTMnKS52ZXJib3NlKCk7XG5jb25zdCBwYXRoID0gcmVxdWlyZSgncGF0aCcpO1xuXG4vLyBDcmVhdGUgZGF0YWJhc2UgZmlsZSBpbiBwcm9qZWN0IHJvb3RcbmNvbnN0IGRiUGF0aCA9IHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCAndGhyZWFkc19hcHAuZGInKTtcblxuLy8gQ3JlYXRlIGRhdGFiYXNlIGNvbm5lY3Rpb25cbmxldCBkYiA9IG51bGw7XG5cbmNvbnN0IGluaXREYXRhYmFzZSA9ICgpID0+IHtcbiAgaWYgKGRiKSByZXR1cm4gZGI7XG4gIFxuICBkYiA9IG5ldyBzcWxpdGUzLkRhdGFiYXNlKGRiUGF0aCwgKGVycikgPT4ge1xuICAgIGlmIChlcnIpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBFcnJvciBvcGVuaW5nIGRhdGFiYXNlOicsIGVyci5tZXNzYWdlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc29sZS5sb2coJ+KchSBDb25uZWN0ZWQgdG8gU1FMaXRlIGRhdGFiYXNlJyk7XG4gICAgfVxuICB9KTtcblxuICAvLyBFbmFibGUgZm9yZWlnbiBrZXlzXG4gIGRiLnJ1bignUFJBR01BIGZvcmVpZ25fa2V5cyA9IE9OJyk7XG4gIFxuICByZXR1cm4gZGI7XG59O1xuXG4vLyBEYXRhYmFzZSBoZWxwZXIgZnVuY3Rpb25zXG5jb25zdCBkYXRhYmFzZSA9IHtcbiAgLy8gSW5pdGlhbGl6ZSBkYXRhYmFzZSBjb25uZWN0aW9uXG4gIGluaXQ6ICgpID0+IHtcbiAgICByZXR1cm4gaW5pdERhdGFiYXNlKCk7XG4gIH0sXG5cbiAgLy8gRXhlY3V0ZSBhIHF1ZXJ5XG4gIHF1ZXJ5OiAoc3FsLCBwYXJhbXMgPSBbXSkgPT4ge1xuICAgIGNvbnN0IGRiID0gaW5pdERhdGFiYXNlKCk7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIGlmIChzcWwudHJpbSgpLnRvVXBwZXJDYXNlKCkuc3RhcnRzV2l0aCgnU0VMRUNUJykpIHtcbiAgICAgICAgZGIuYWxsKHNxbCwgcGFyYW1zLCAoZXJyLCByb3dzKSA9PiB7XG4gICAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcign4p2MIERhdGFiYXNlIHF1ZXJ5IGVycm9yOicsIGVycik7XG4gICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVzb2x2ZSh7IHN1Y2Nlc3M6IHRydWUsIHJvd3MgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGRiLnJ1bihzcWwsIHBhcmFtcywgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcign4p2MIERhdGFiYXNlIHF1ZXJ5IGVycm9yOicsIGVycik7XG4gICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVzb2x2ZSh7IFxuICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICByb3dDb3VudDogdGhpcy5jaGFuZ2VzLFxuICAgICAgICAgICAgICBsYXN0SUQ6IHRoaXMubGFzdElELFxuICAgICAgICAgICAgICByb3dzOiB0aGlzLmxhc3RJRCA/IFt7IGlkOiB0aGlzLmxhc3RJRCB9XSA6IFtdXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0pO1xuICB9LFxuXG4gIC8vIEdldCBhIHNpbmdsZSByb3dcbiAgZ2V0OiAoc3FsLCBwYXJhbXMgPSBbXSkgPT4ge1xuICAgIGNvbnN0IGRiID0gaW5pdERhdGFiYXNlKCk7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIGRiLmdldChzcWwsIHBhcmFtcywgKGVyciwgcm93KSA9PiB7XG4gICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCfinYwgRGF0YWJhc2UgcXVlcnkgZXJyb3I6JywgZXJyKTtcbiAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXNvbHZlKHsgc3VjY2VzczogdHJ1ZSwgcm93czogcm93ID8gW3Jvd10gOiBbXSB9KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gIH0sXG5cbiAgLy8gQ2xvc2UgZGF0YWJhc2UgY29ubmVjdGlvblxuICBjbG9zZTogKCkgPT4ge1xuICAgIGlmIChkYikge1xuICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgICAgIGRiLmNsb3NlKChlcnIpID0+IHtcbiAgICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCfinYwgRXJyb3IgY2xvc2luZyBkYXRhYmFzZTonLCBlcnIubWVzc2FnZSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCfinIUgRGF0YWJhc2UgY29ubmVjdGlvbiBjbG9zZWQnKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZGIgPSBudWxsO1xuICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICB9LFxuXG4gIC8vIFRyYW5zYWN0aW9uIGhlbHBlclxuICB0cmFuc2FjdGlvbjogYXN5bmMgKGNhbGxiYWNrKSA9PiB7XG4gICAgY29uc3QgZGIgPSBpbml0RGF0YWJhc2UoKTtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgZGF0YWJhc2UucXVlcnkoJ0JFR0lOIFRSQU5TQUNUSU9OJyk7XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjYWxsYmFjayhkYXRhYmFzZSk7XG4gICAgICBhd2FpdCBkYXRhYmFzZS5xdWVyeSgnQ09NTUlUJyk7XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBhd2FpdCBkYXRhYmFzZS5xdWVyeSgnUk9MTEJBQ0snKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBkYXRhYmFzZTtcbiJdLCJuYW1lcyI6WyJzcWxpdGUzIiwicmVxdWlyZSIsInZlcmJvc2UiLCJwYXRoIiwiZGJQYXRoIiwiam9pbiIsInByb2Nlc3MiLCJjd2QiLCJkYiIsImluaXREYXRhYmFzZSIsIkRhdGFiYXNlIiwiZXJyIiwiY29uc29sZSIsImVycm9yIiwibWVzc2FnZSIsImxvZyIsInJ1biIsImRhdGFiYXNlIiwiaW5pdCIsInF1ZXJ5Iiwic3FsIiwicGFyYW1zIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJ0cmltIiwidG9VcHBlckNhc2UiLCJzdGFydHNXaXRoIiwiYWxsIiwicm93cyIsInN1Y2Nlc3MiLCJyb3dDb3VudCIsImNoYW5nZXMiLCJsYXN0SUQiLCJpZCIsImdldCIsInJvdyIsImNsb3NlIiwidHJhbnNhY3Rpb24iLCJjYWxsYmFjayIsInJlc3VsdCIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./database/db.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/semver","vendor-chunks/bcryptjs","vendor-chunks/jsonwebtoken","vendor-chunks/lodash.includes","vendor-chunks/jws","vendor-chunks/lodash.once","vendor-chunks/jwa","vendor-chunks/lodash.isinteger","vendor-chunks/ecdsa-sig-formatter","vendor-chunks/lodash.isplainobject","vendor-chunks/ms","vendor-chunks/lodash.isstring","vendor-chunks/lodash.isnumber","vendor-chunks/lodash.isboolean","vendor-chunks/safe-buffer","vendor-chunks/buffer-equal-constant-time"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fupload%2Froute&page=%2Fapi%2Fupload%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fupload%2Froute.ts&appDir=%2FUsers%2Friciboy%2FDesktop%2Fgaladarbinsskola%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Friciboy%2FDesktop%2Fgaladarbinsskola&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();