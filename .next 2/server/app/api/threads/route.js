"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/threads/route";
exports.ids = ["app/api/threads/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "sqlite3":
/*!**************************!*\
  !*** external "sqlite3" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("sqlite3");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fthreads%2Froute&page=%2Fapi%2Fthreads%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fthreads%2Froute.ts&appDir=%2FUsers%2Friciboy%2FDesktop%2Fgaladarbinsskola%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Friciboy%2FDesktop%2Fgaladarbinsskola&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fthreads%2Froute&page=%2Fapi%2Fthreads%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fthreads%2Froute.ts&appDir=%2FUsers%2Friciboy%2FDesktop%2Fgaladarbinsskola%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Friciboy%2FDesktop%2Fgaladarbinsskola&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_riciboy_Desktop_galadarbinsskola_app_api_threads_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/threads/route.ts */ \"(rsc)/./app/api/threads/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/threads/route\",\n        pathname: \"/api/threads\",\n        filename: \"route\",\n        bundlePath: \"app/api/threads/route\"\n    },\n    resolvedPagePath: \"/Users/riciboy/Desktop/galadarbinsskola/app/api/threads/route.ts\",\n    nextConfigOutput,\n    userland: _Users_riciboy_Desktop_galadarbinsskola_app_api_threads_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/threads/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZ0aHJlYWRzJTJGcm91dGUmcGFnZT0lMkZhcGklMkZ0aHJlYWRzJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGdGhyZWFkcyUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRnJpY2lib3klMkZEZXNrdG9wJTJGZ2FsYWRhcmJpbnNza29sYSUyRmFwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9JTJGVXNlcnMlMkZyaWNpYm95JTJGRGVza3RvcCUyRmdhbGFkYXJiaW5zc2tvbGEmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQ2dCO0FBQzdGO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaUVBQWlFO0FBQ3pFO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDdUg7O0FBRXZIIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdGhyZWFkcy1hcHAtYmVldC8/N2NlNiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIvVXNlcnMvcmljaWJveS9EZXNrdG9wL2dhbGFkYXJiaW5zc2tvbGEvYXBwL2FwaS90aHJlYWRzL3JvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS90aHJlYWRzL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvdGhyZWFkc1wiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvdGhyZWFkcy9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIi9Vc2Vycy9yaWNpYm95L0Rlc2t0b3AvZ2FsYWRhcmJpbnNza29sYS9hcHAvYXBpL3RocmVhZHMvcm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL3RocmVhZHMvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fthreads%2Froute&page=%2Fapi%2Fthreads%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fthreads%2Froute.ts&appDir=%2FUsers%2Friciboy%2FDesktop%2Fgaladarbinsskola%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Friciboy%2FDesktop%2Fgaladarbinsskola&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/auth/db.js":
/*!****************************!*\
  !*** ./app/api/auth/db.js ***!
  \****************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

eval("\nconst db = __webpack_require__(/*! ../../../database/db */ \"(rsc)/./database/db.js\");\nconst bcrypt = __webpack_require__(/*! bcryptjs */ \"(rsc)/./node_modules/bcryptjs/index.js\");\nconst jwt = __webpack_require__(/*! jsonwebtoken */ \"(rsc)/./node_modules/jsonwebtoken/index.js\");\nconst crypto = __webpack_require__(/*! crypto */ \"crypto\");\n// JWT configuration\nconst JWT_SECRET = process.env.JWT_SECRET || \"your-super-secret-jwt-key\";\nconst JWT_EXPIRES_IN = process.env.JWT_EXPIRES_IN || \"7d\";\n// User authentication functions\nconst createUser = async (userData)=>{\n    const { username, displayName, email, password, avatar, bio } = userData;\n    try {\n        // Check if user already exists\n        const existingUser = await getUserByEmail(email);\n        if (existingUser) {\n            throw new Error(\"User with this email already exists\");\n        }\n        const existingUsername = await getUserByUsername(username);\n        if (existingUsername) {\n            throw new Error(\"Username already taken\");\n        }\n        // Hash password\n        const passwordHash = await bcrypt.hash(password, 12);\n        const userId = crypto.randomUUID();\n        // Create user\n        const result = await db.query(`\n      INSERT INTO users (id, username, display_name, email, password_hash, avatar, bio)\n      VALUES (?, ?, ?, ?, ?, ?, ?)\n    `, [\n            userId,\n            username,\n            displayName,\n            email,\n            passwordHash,\n            avatar || null,\n            bio || null\n        ]);\n        // Return user without password\n        const newUser = await getUserById(userId);\n        return newUser;\n    } catch (error) {\n        console.error(\"Error creating user:\", error);\n        throw error;\n    }\n};\nconst getUserByEmail = async (email)=>{\n    try {\n        const result = await db.get(\"SELECT * FROM users WHERE email = ?\", [\n            email\n        ]);\n        return result.rows[0] || null;\n    } catch (error) {\n        console.error(\"Error getting user by email:\", error);\n        throw error;\n    }\n};\nconst getUserByUsername = async (username)=>{\n    try {\n        const result = await db.get(\"SELECT * FROM users WHERE username = ?\", [\n            username\n        ]);\n        return result.rows[0] || null;\n    } catch (error) {\n        console.error(\"Error getting user by username:\", error);\n        throw error;\n    }\n};\nconst getUserById = async (id)=>{\n    try {\n        const result = await db.get(\"SELECT * FROM users WHERE id = ?\", [\n            id\n        ]);\n        return result.rows[0] || null;\n    } catch (error) {\n        console.error(\"Error getting user by ID:\", error);\n        throw error;\n    }\n};\nconst getAllUsers = async ()=>{\n    try {\n        const result = await db.query(`\n      SELECT \n        id, username, display_name, email, avatar, bio, \n        created_at, following, followers\n      FROM users\n      ORDER BY created_at DESC\n    `);\n        return result.rows;\n    } catch (error) {\n        console.error(\"Error getting all users:\", error);\n        throw error;\n    }\n};\nconst updateUser = async (id, updateData)=>{\n    try {\n        const { username, displayName, email, avatar, bio, following, followers } = updateData;\n        // Check if username is taken by another user\n        if (username) {\n            const existingUser = await getUserByUsername(username);\n            if (existingUser && existingUser.id !== id) {\n                throw new Error(\"Username already taken\");\n            }\n        }\n        // Check if email is taken by another user\n        if (email) {\n            const existingUser = await getUserByEmail(email);\n            if (existingUser && existingUser.id !== id) {\n                throw new Error(\"Email already taken\");\n            }\n        }\n        await db.query(`\n      UPDATE users \n      SET username = COALESCE(?, username),\n          display_name = COALESCE(?, display_name),\n          email = COALESCE(?, email),\n          avatar = COALESCE(?, avatar),\n          bio = COALESCE(?, bio),\n          following = COALESCE(?, following),\n          followers = COALESCE(?, followers),\n          updated_at = CURRENT_TIMESTAMP\n      WHERE id = ?\n    `, [\n            username,\n            displayName,\n            email,\n            avatar,\n            bio,\n            following,\n            followers,\n            id\n        ]);\n        return await getUserById(id);\n    } catch (error) {\n        console.error(\"Error updating user:\", error);\n        throw error;\n    }\n};\nconst deleteUser = async (id)=>{\n    try {\n        await db.query(\"DELETE FROM users WHERE id = ?\", [\n            id\n        ]);\n        await db.query(\"DELETE FROM user_sessions WHERE user_id = ?\", [\n            id\n        ]);\n        return true;\n    } catch (error) {\n        console.error(\"Error deleting user:\", error);\n        throw error;\n    }\n};\nconst verifyUserPassword = async (email, password)=>{\n    try {\n        const user = await getUserByEmail(email);\n        if (!user) {\n            return null;\n        }\n        const isValid = await bcrypt.compare(password, user.password_hash);\n        return isValid ? user : null;\n    } catch (error) {\n        console.error(\"Error verifying password:\", error);\n        throw error;\n    }\n};\n// JWT token functions\nconst generateToken = (user)=>{\n    const payload = {\n        id: user.id,\n        email: user.email,\n        username: user.username\n    };\n    return jwt.sign(payload, JWT_SECRET, {\n        expiresIn: JWT_EXPIRES_IN\n    });\n};\nconst verifyToken = (token)=>{\n    try {\n        return jwt.verify(token, JWT_SECRET);\n    } catch (error) {\n        return null;\n    }\n};\n// Session management\nconst createSession = async (userId, token, ipAddress, userAgent)=>{\n    try {\n        const sessionId = crypto.randomUUID();\n        const expiresAt = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000); // 7 days\n        await db.query(`\n      INSERT INTO user_sessions (id, user_id, session_token, expires_at)\n      VALUES (?, ?, ?, ?)\n    `, [\n            sessionId,\n            userId,\n            token,\n            expiresAt.toISOString()\n        ]);\n        return sessionId;\n    } catch (error) {\n        console.error(\"Error creating session:\", error);\n        throw error;\n    }\n};\nconst getSession = async (token)=>{\n    try {\n        const result = await db.get(`\n      SELECT s.*, u.id as user_id, u.username, u.display_name, u.email, u.avatar, u.bio\n      FROM user_sessions s\n      JOIN users u ON s.user_id = u.id\n      WHERE s.session_token = ? AND s.expires_at > datetime('now')\n    `, [\n            token\n        ]);\n        return result.rows[0] || null;\n    } catch (error) {\n        console.error(\"Error getting session:\", error);\n        throw error;\n    }\n};\nconst deleteSession = async (token)=>{\n    try {\n        await db.query(\"DELETE FROM user_sessions WHERE session_token = ?\", [\n            token\n        ]);\n        return true;\n    } catch (error) {\n        console.error(\"Error deleting session:\", error);\n        throw error;\n    }\n};\nconst deleteAllUserSessions = async (userId)=>{\n    try {\n        await db.query(\"DELETE FROM user_sessions WHERE user_id = ?\", [\n            userId\n        ]);\n        return true;\n    } catch (error) {\n        console.error(\"Error deleting user sessions:\", error);\n        throw error;\n    }\n};\nmodule.exports = {\n    createUser,\n    getUserByEmail,\n    getUserByUsername,\n    getUserById,\n    getAllUsers,\n    updateUser,\n    deleteUser,\n    verifyUserPassword,\n    generateToken,\n    verifyToken,\n    createSession,\n    getSession,\n    deleteSession,\n    deleteAllUserSessions\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUMsRUFBRTtZQUFDbUI7U0FBTTtRQUVWLE9BQU96QixPQUFPTyxJQUFJLENBQUMsRUFBRSxJQUFJO0lBQzNCLEVBQUUsT0FBT0gsT0FBTztRQUNkQyxRQUFRRCxLQUFLLENBQUMsMEJBQTBCQTtRQUN4QyxNQUFNQTtJQUNSO0FBQ0Y7QUFFQSxNQUFNZ0MsZ0JBQWdCLE9BQU9YO0lBQzNCLElBQUk7UUFDRixNQUFNbkQsR0FBRzJCLEtBQUssQ0FBQyxxREFBcUQ7WUFBQ3dCO1NBQU07UUFDM0UsT0FBTztJQUNULEVBQUUsT0FBT3JCLE9BQU87UUFDZEMsUUFBUUQsS0FBSyxDQUFDLDJCQUEyQkE7UUFDekMsTUFBTUE7SUFDUjtBQUNGO0FBRUEsTUFBTWlDLHdCQUF3QixPQUFPdkM7SUFDbkMsSUFBSTtRQUNGLE1BQU14QixHQUFHMkIsS0FBSyxDQUFDLCtDQUErQztZQUFDSDtTQUFPO1FBQ3RFLE9BQU87SUFDVCxFQUFFLE9BQU9NLE9BQU87UUFDZEMsUUFBUUQsS0FBSyxDQUFDLGlDQUFpQ0E7UUFDL0MsTUFBTUE7SUFDUjtBQUNGO0FBRUFrQyxPQUFPQyxPQUFPLEdBQUc7SUFDZnhEO0lBQ0FTO0lBQ0FHO0lBQ0FRO0lBQ0FNO0lBQ0FDO0lBQ0FJO0lBQ0FDO0lBQ0FLO0lBQ0FJO0lBQ0FHO0lBQ0FRO0lBQ0FDO0lBQ0FDO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90aHJlYWRzLWFwcC1iZWV0Ly4vYXBwL2FwaS9hdXRoL2RiLmpzP2I4NzMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZGIgPSByZXF1aXJlKCcuLi8uLi8uLi9kYXRhYmFzZS9kYicpO1xuY29uc3QgYmNyeXB0ID0gcmVxdWlyZSgnYmNyeXB0anMnKTtcbmNvbnN0IGp3dCA9IHJlcXVpcmUoJ2pzb253ZWJ0b2tlbicpO1xuY29uc3QgY3J5cHRvID0gcmVxdWlyZSgnY3J5cHRvJyk7XG5cbi8vIEpXVCBjb25maWd1cmF0aW9uXG5jb25zdCBKV1RfU0VDUkVUID0gcHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCB8fCAneW91ci1zdXBlci1zZWNyZXQtand0LWtleSc7XG5jb25zdCBKV1RfRVhQSVJFU19JTiA9IHByb2Nlc3MuZW52LkpXVF9FWFBJUkVTX0lOIHx8ICc3ZCc7XG5cbi8vIFVzZXIgYXV0aGVudGljYXRpb24gZnVuY3Rpb25zXG5jb25zdCBjcmVhdGVVc2VyID0gYXN5bmMgKHVzZXJEYXRhKSA9PiB7XG4gIGNvbnN0IHsgdXNlcm5hbWUsIGRpc3BsYXlOYW1lLCBlbWFpbCwgcGFzc3dvcmQsIGF2YXRhciwgYmlvIH0gPSB1c2VyRGF0YTtcbiAgXG4gIHRyeSB7XG4gICAgLy8gQ2hlY2sgaWYgdXNlciBhbHJlYWR5IGV4aXN0c1xuICAgIGNvbnN0IGV4aXN0aW5nVXNlciA9IGF3YWl0IGdldFVzZXJCeUVtYWlsKGVtYWlsKTtcbiAgICBpZiAoZXhpc3RpbmdVc2VyKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1VzZXIgd2l0aCB0aGlzIGVtYWlsIGFscmVhZHkgZXhpc3RzJyk7XG4gICAgfVxuICAgIFxuICAgIGNvbnN0IGV4aXN0aW5nVXNlcm5hbWUgPSBhd2FpdCBnZXRVc2VyQnlVc2VybmFtZSh1c2VybmFtZSk7XG4gICAgaWYgKGV4aXN0aW5nVXNlcm5hbWUpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignVXNlcm5hbWUgYWxyZWFkeSB0YWtlbicpO1xuICAgIH1cbiAgICBcbiAgICAvLyBIYXNoIHBhc3N3b3JkXG4gICAgY29uc3QgcGFzc3dvcmRIYXNoID0gYXdhaXQgYmNyeXB0Lmhhc2gocGFzc3dvcmQsIDEyKTtcbiAgICBjb25zdCB1c2VySWQgPSBjcnlwdG8ucmFuZG9tVVVJRCgpO1xuICAgIFxuICAgIC8vIENyZWF0ZSB1c2VyXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIucXVlcnkoYFxuICAgICAgSU5TRVJUIElOVE8gdXNlcnMgKGlkLCB1c2VybmFtZSwgZGlzcGxheV9uYW1lLCBlbWFpbCwgcGFzc3dvcmRfaGFzaCwgYXZhdGFyLCBiaW8pXG4gICAgICBWQUxVRVMgKD8sID8sID8sID8sID8sID8sID8pXG4gICAgYCwgW3VzZXJJZCwgdXNlcm5hbWUsIGRpc3BsYXlOYW1lLCBlbWFpbCwgcGFzc3dvcmRIYXNoLCBhdmF0YXIgfHwgbnVsbCwgYmlvIHx8IG51bGxdKTtcbiAgICBcbiAgICAvLyBSZXR1cm4gdXNlciB3aXRob3V0IHBhc3N3b3JkXG4gICAgY29uc3QgbmV3VXNlciA9IGF3YWl0IGdldFVzZXJCeUlkKHVzZXJJZCk7XG4gICAgcmV0dXJuIG5ld1VzZXI7XG4gICAgXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgdXNlcjonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn07XG5cbmNvbnN0IGdldFVzZXJCeUVtYWlsID0gYXN5bmMgKGVtYWlsKSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuZ2V0KCdTRUxFQ1QgKiBGUk9NIHVzZXJzIFdIRVJFIGVtYWlsID0gPycsIFtlbWFpbF0pO1xuICAgIHJldHVybiByZXN1bHQucm93c1swXSB8fCBudWxsO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdldHRpbmcgdXNlciBieSBlbWFpbDonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn07XG5cbmNvbnN0IGdldFVzZXJCeVVzZXJuYW1lID0gYXN5bmMgKHVzZXJuYW1lKSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuZ2V0KCdTRUxFQ1QgKiBGUk9NIHVzZXJzIFdIRVJFIHVzZXJuYW1lID0gPycsIFt1c2VybmFtZV0pO1xuICAgIHJldHVybiByZXN1bHQucm93c1swXSB8fCBudWxsO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdldHRpbmcgdXNlciBieSB1c2VybmFtZTonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn07XG5cbmNvbnN0IGdldFVzZXJCeUlkID0gYXN5bmMgKGlkKSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuZ2V0KCdTRUxFQ1QgKiBGUk9NIHVzZXJzIFdIRVJFIGlkID0gPycsIFtpZF0pO1xuICAgIHJldHVybiByZXN1bHQucm93c1swXSB8fCBudWxsO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdldHRpbmcgdXNlciBieSBJRDonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn07XG5cbmNvbnN0IGdldEFsbFVzZXJzID0gYXN5bmMgKCkgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLnF1ZXJ5KGBcbiAgICAgIFNFTEVDVCBcbiAgICAgICAgaWQsIHVzZXJuYW1lLCBkaXNwbGF5X25hbWUsIGVtYWlsLCBhdmF0YXIsIGJpbywgXG4gICAgICAgIGNyZWF0ZWRfYXQsIGZvbGxvd2luZywgZm9sbG93ZXJzXG4gICAgICBGUk9NIHVzZXJzXG4gICAgICBPUkRFUiBCWSBjcmVhdGVkX2F0IERFU0NcbiAgICBgKTtcbiAgICByZXR1cm4gcmVzdWx0LnJvd3M7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZ2V0dGluZyBhbGwgdXNlcnM6JywgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xuICB9XG59O1xuXG5jb25zdCB1cGRhdGVVc2VyID0gYXN5bmMgKGlkLCB1cGRhdGVEYXRhKSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgeyB1c2VybmFtZSwgZGlzcGxheU5hbWUsIGVtYWlsLCBhdmF0YXIsIGJpbywgZm9sbG93aW5nLCBmb2xsb3dlcnMgfSA9IHVwZGF0ZURhdGE7XG4gICAgXG4gICAgLy8gQ2hlY2sgaWYgdXNlcm5hbWUgaXMgdGFrZW4gYnkgYW5vdGhlciB1c2VyXG4gICAgaWYgKHVzZXJuYW1lKSB7XG4gICAgICBjb25zdCBleGlzdGluZ1VzZXIgPSBhd2FpdCBnZXRVc2VyQnlVc2VybmFtZSh1c2VybmFtZSk7XG4gICAgICBpZiAoZXhpc3RpbmdVc2VyICYmIGV4aXN0aW5nVXNlci5pZCAhPT0gaWQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdVc2VybmFtZSBhbHJlYWR5IHRha2VuJyk7XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8vIENoZWNrIGlmIGVtYWlsIGlzIHRha2VuIGJ5IGFub3RoZXIgdXNlclxuICAgIGlmIChlbWFpbCkge1xuICAgICAgY29uc3QgZXhpc3RpbmdVc2VyID0gYXdhaXQgZ2V0VXNlckJ5RW1haWwoZW1haWwpO1xuICAgICAgaWYgKGV4aXN0aW5nVXNlciAmJiBleGlzdGluZ1VzZXIuaWQgIT09IGlkKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignRW1haWwgYWxyZWFkeSB0YWtlbicpO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICBhd2FpdCBkYi5xdWVyeShgXG4gICAgICBVUERBVEUgdXNlcnMgXG4gICAgICBTRVQgdXNlcm5hbWUgPSBDT0FMRVNDRSg/LCB1c2VybmFtZSksXG4gICAgICAgICAgZGlzcGxheV9uYW1lID0gQ09BTEVTQ0UoPywgZGlzcGxheV9uYW1lKSxcbiAgICAgICAgICBlbWFpbCA9IENPQUxFU0NFKD8sIGVtYWlsKSxcbiAgICAgICAgICBhdmF0YXIgPSBDT0FMRVNDRSg/LCBhdmF0YXIpLFxuICAgICAgICAgIGJpbyA9IENPQUxFU0NFKD8sIGJpbyksXG4gICAgICAgICAgZm9sbG93aW5nID0gQ09BTEVTQ0UoPywgZm9sbG93aW5nKSxcbiAgICAgICAgICBmb2xsb3dlcnMgPSBDT0FMRVNDRSg/LCBmb2xsb3dlcnMpLFxuICAgICAgICAgIHVwZGF0ZWRfYXQgPSBDVVJSRU5UX1RJTUVTVEFNUFxuICAgICAgV0hFUkUgaWQgPSA/XG4gICAgYCwgW3VzZXJuYW1lLCBkaXNwbGF5TmFtZSwgZW1haWwsIGF2YXRhciwgYmlvLCBmb2xsb3dpbmcsIGZvbGxvd2VycywgaWRdKTtcbiAgICBcbiAgICByZXR1cm4gYXdhaXQgZ2V0VXNlckJ5SWQoaWQpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIHVzZXI6JywgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xuICB9XG59O1xuXG5jb25zdCBkZWxldGVVc2VyID0gYXN5bmMgKGlkKSA9PiB7XG4gIHRyeSB7XG4gICAgYXdhaXQgZGIucXVlcnkoJ0RFTEVURSBGUk9NIHVzZXJzIFdIRVJFIGlkID0gPycsIFtpZF0pO1xuICAgIGF3YWl0IGRiLnF1ZXJ5KCdERUxFVEUgRlJPTSB1c2VyX3Nlc3Npb25zIFdIRVJFIHVzZXJfaWQgPSA/JywgW2lkXSk7XG4gICAgcmV0dXJuIHRydWU7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVsZXRpbmcgdXNlcjonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn07XG5cbmNvbnN0IHZlcmlmeVVzZXJQYXNzd29yZCA9IGFzeW5jIChlbWFpbCwgcGFzc3dvcmQpID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCB1c2VyID0gYXdhaXQgZ2V0VXNlckJ5RW1haWwoZW1haWwpO1xuICAgIGlmICghdXNlcikge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIFxuICAgIGNvbnN0IGlzVmFsaWQgPSBhd2FpdCBiY3J5cHQuY29tcGFyZShwYXNzd29yZCwgdXNlci5wYXNzd29yZF9oYXNoKTtcbiAgICByZXR1cm4gaXNWYWxpZCA/IHVzZXIgOiBudWxsO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHZlcmlmeWluZyBwYXNzd29yZDonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn07XG5cbi8vIEpXVCB0b2tlbiBmdW5jdGlvbnNcbmNvbnN0IGdlbmVyYXRlVG9rZW4gPSAodXNlcikgPT4ge1xuICBjb25zdCBwYXlsb2FkID0ge1xuICAgIGlkOiB1c2VyLmlkLFxuICAgIGVtYWlsOiB1c2VyLmVtYWlsLFxuICAgIHVzZXJuYW1lOiB1c2VyLnVzZXJuYW1lXG4gIH07XG4gIFxuICByZXR1cm4gand0LnNpZ24ocGF5bG9hZCwgSldUX1NFQ1JFVCwgeyBleHBpcmVzSW46IEpXVF9FWFBJUkVTX0lOIH0pO1xufTtcblxuY29uc3QgdmVyaWZ5VG9rZW4gPSAodG9rZW4pID0+IHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gand0LnZlcmlmeSh0b2tlbiwgSldUX1NFQ1JFVCk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn07XG5cbi8vIFNlc3Npb24gbWFuYWdlbWVudFxuY29uc3QgY3JlYXRlU2Vzc2lvbiA9IGFzeW5jICh1c2VySWQsIHRva2VuLCBpcEFkZHJlc3MsIHVzZXJBZ2VudCkgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHNlc3Npb25JZCA9IGNyeXB0by5yYW5kb21VVUlEKCk7XG4gICAgY29uc3QgZXhwaXJlc0F0ID0gbmV3IERhdGUoRGF0ZS5ub3coKSArIDcgKiAyNCAqIDYwICogNjAgKiAxMDAwKTsgLy8gNyBkYXlzXG4gICAgXG4gICAgYXdhaXQgZGIucXVlcnkoYFxuICAgICAgSU5TRVJUIElOVE8gdXNlcl9zZXNzaW9ucyAoaWQsIHVzZXJfaWQsIHNlc3Npb25fdG9rZW4sIGV4cGlyZXNfYXQpXG4gICAgICBWQUxVRVMgKD8sID8sID8sID8pXG4gICAgYCwgW3Nlc3Npb25JZCwgdXNlcklkLCB0b2tlbiwgZXhwaXJlc0F0LnRvSVNPU3RyaW5nKCldKTtcbiAgICBcbiAgICByZXR1cm4gc2Vzc2lvbklkO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIHNlc3Npb246JywgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xuICB9XG59O1xuXG5jb25zdCBnZXRTZXNzaW9uID0gYXN5bmMgKHRva2VuKSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuZ2V0KGBcbiAgICAgIFNFTEVDVCBzLiosIHUuaWQgYXMgdXNlcl9pZCwgdS51c2VybmFtZSwgdS5kaXNwbGF5X25hbWUsIHUuZW1haWwsIHUuYXZhdGFyLCB1LmJpb1xuICAgICAgRlJPTSB1c2VyX3Nlc3Npb25zIHNcbiAgICAgIEpPSU4gdXNlcnMgdSBPTiBzLnVzZXJfaWQgPSB1LmlkXG4gICAgICBXSEVSRSBzLnNlc3Npb25fdG9rZW4gPSA/IEFORCBzLmV4cGlyZXNfYXQgPiBkYXRldGltZSgnbm93JylcbiAgICBgLCBbdG9rZW5dKTtcbiAgICBcbiAgICByZXR1cm4gcmVzdWx0LnJvd3NbMF0gfHwgbnVsbDtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZXR0aW5nIHNlc3Npb246JywgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xuICB9XG59O1xuXG5jb25zdCBkZWxldGVTZXNzaW9uID0gYXN5bmMgKHRva2VuKSA9PiB7XG4gIHRyeSB7XG4gICAgYXdhaXQgZGIucXVlcnkoJ0RFTEVURSBGUk9NIHVzZXJfc2Vzc2lvbnMgV0hFUkUgc2Vzc2lvbl90b2tlbiA9ID8nLCBbdG9rZW5dKTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBzZXNzaW9uOicsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxufTtcblxuY29uc3QgZGVsZXRlQWxsVXNlclNlc3Npb25zID0gYXN5bmMgKHVzZXJJZCkgPT4ge1xuICB0cnkge1xuICAgIGF3YWl0IGRiLnF1ZXJ5KCdERUxFVEUgRlJPTSB1c2VyX3Nlc3Npb25zIFdIRVJFIHVzZXJfaWQgPSA/JywgW3VzZXJJZF0pO1xuICAgIHJldHVybiB0cnVlO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIHVzZXIgc2Vzc2lvbnM6JywgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xuICB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgY3JlYXRlVXNlcixcbiAgZ2V0VXNlckJ5RW1haWwsXG4gIGdldFVzZXJCeVVzZXJuYW1lLFxuICBnZXRVc2VyQnlJZCxcbiAgZ2V0QWxsVXNlcnMsXG4gIHVwZGF0ZVVzZXIsXG4gIGRlbGV0ZVVzZXIsXG4gIHZlcmlmeVVzZXJQYXNzd29yZCxcbiAgZ2VuZXJhdGVUb2tlbixcbiAgdmVyaWZ5VG9rZW4sXG4gIGNyZWF0ZVNlc3Npb24sXG4gIGdldFNlc3Npb24sXG4gIGRlbGV0ZVNlc3Npb24sXG4gIGRlbGV0ZUFsbFVzZXJTZXNzaW9uc1xufTtcbiJdLCJuYW1lcyI6WyJkYiIsInJlcXVpcmUiLCJiY3J5cHQiLCJqd3QiLCJjcnlwdG8iLCJKV1RfU0VDUkVUIiwicHJvY2VzcyIsImVudiIsIkpXVF9FWFBJUkVTX0lOIiwiY3JlYXRlVXNlciIsInVzZXJEYXRhIiwidXNlcm5hbWUiLCJkaXNwbGF5TmFtZSIsImVtYWlsIiwicGFzc3dvcmQiLCJhdmF0YXIiLCJiaW8iLCJleGlzdGluZ1VzZXIiLCJnZXRVc2VyQnlFbWFpbCIsIkVycm9yIiwiZXhpc3RpbmdVc2VybmFtZSIsImdldFVzZXJCeVVzZXJuYW1lIiwicGFzc3dvcmRIYXNoIiwiaGFzaCIsInVzZXJJZCIsInJhbmRvbVVVSUQiLCJyZXN1bHQiLCJxdWVyeSIsIm5ld1VzZXIiLCJnZXRVc2VyQnlJZCIsImVycm9yIiwiY29uc29sZSIsImdldCIsInJvd3MiLCJpZCIsImdldEFsbFVzZXJzIiwidXBkYXRlVXNlciIsInVwZGF0ZURhdGEiLCJmb2xsb3dpbmciLCJmb2xsb3dlcnMiLCJkZWxldGVVc2VyIiwidmVyaWZ5VXNlclBhc3N3b3JkIiwidXNlciIsImlzVmFsaWQiLCJjb21wYXJlIiwicGFzc3dvcmRfaGFzaCIsImdlbmVyYXRlVG9rZW4iLCJwYXlsb2FkIiwic2lnbiIsImV4cGlyZXNJbiIsInZlcmlmeVRva2VuIiwidG9rZW4iLCJ2ZXJpZnkiLCJjcmVhdGVTZXNzaW9uIiwiaXBBZGRyZXNzIiwidXNlckFnZW50Iiwic2Vzc2lvbklkIiwiZXhwaXJlc0F0IiwiRGF0ZSIsIm5vdyIsInRvSVNPU3RyaW5nIiwiZ2V0U2Vzc2lvbiIsImRlbGV0ZVNlc3Npb24iLCJkZWxldGVBbGxVc2VyU2Vzc2lvbnMiLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/auth/db.js\n");

/***/ }),

/***/ "(rsc)/./app/api/threads/db.js":
/*!*******************************!*\
  !*** ./app/api/threads/db.js ***!
  \*******************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

eval("\nconst db = __webpack_require__(/*! ../../../database/db */ \"(rsc)/./database/db.js\");\nconst crypto = __webpack_require__(/*! crypto */ \"crypto\");\n// Thread functions\nconst createThread = async (threadData)=>{\n    const { authorId, content, visibility, parentId, attachments, groupId, topicDayId } = threadData;\n    try {\n        const threadId = crypto.randomUUID();\n        await db.query(`\n      INSERT INTO threads (id, author_id, content, parent_id, group_id, topic_day_id, visibility, attachments)\n      VALUES (?, ?, ?, ?, ?, ?, ?, ?)\n    `, [\n            threadId,\n            authorId,\n            content,\n            parentId || null,\n            groupId || null,\n            topicDayId || null,\n            visibility || \"public\",\n            JSON.stringify(attachments || [])\n        ]);\n        return await getThreadById(threadId);\n    } catch (error) {\n        console.error(\"Error creating thread:\", error);\n        throw error;\n    }\n};\nconst getThreadById = async (id)=>{\n    try {\n        const result = await db.get(`\n      SELECT \n        t.id, t.author_id, t.content, t.parent_id, t.group_id, t.topic_day_id,\n        t.visibility, t.attachments, t.likes, t.dislikes, t.created_at, t.updated_at,\n        u.username, u.display_name, u.avatar\n      FROM threads t\n      JOIN users u ON t.author_id = u.id\n      WHERE t.id = ?\n    `, [\n            id\n        ]);\n        if (!result.rows[0]) {\n            return null;\n        }\n        const thread = result.rows[0];\n        return {\n            ...thread,\n            likes: JSON.parse(thread.likes || \"[]\"),\n            dislikes: JSON.parse(thread.dislikes || \"[]\"),\n            attachments: JSON.parse(thread.attachments || \"[]\"),\n            author: {\n                id: thread.author_id,\n                username: thread.username,\n                displayName: thread.display_name,\n                avatar: thread.avatar\n            }\n        };\n    } catch (error) {\n        console.error(\"Error getting thread by ID:\", error);\n        throw error;\n    }\n};\nconst getAllThreads = async (options = {})=>{\n    const { limit = 50, offset = 0, userId = null } = options;\n    try {\n        let query = `\n      SELECT \n        t.id, t.author_id, t.content, t.parent_id, t.group_id, t.topic_day_id,\n        t.visibility, t.attachments, t.likes, t.dislikes, t.created_at, t.updated_at,\n        u.username, u.display_name, u.avatar\n      FROM threads t\n      JOIN users u ON t.author_id = u.id\n      WHERE t.parent_id IS NULL\n    `;\n        const params = [];\n        if (userId) {\n            query += \" AND t.author_id = ?\";\n            params.push(userId);\n        }\n        query += \" ORDER BY t.created_at DESC LIMIT ? OFFSET ?\";\n        params.push(limit, offset);\n        const result = await db.query(query, params);\n        const threads = result.rows.map((thread)=>({\n                ...thread,\n                likes: JSON.parse(thread.likes || \"[]\"),\n                dislikes: JSON.parse(thread.dislikes || \"[]\"),\n                attachments: JSON.parse(thread.attachments || \"[]\"),\n                author: {\n                    id: thread.author_id,\n                    username: thread.username,\n                    displayName: thread.display_name,\n                    avatar: thread.avatar\n                },\n                replies: [],\n                comments: []\n            }));\n        // Get replies for each thread\n        for (const thread of threads){\n            const replies = await getThreadReplies(thread.id);\n            thread.replies = replies;\n        }\n        return threads;\n    } catch (error) {\n        console.error(\"Error getting all threads:\", error);\n        throw error;\n    }\n};\nconst getThreadReplies = async (parentId)=>{\n    try {\n        const result = await db.query(`\n      SELECT \n        t.id, t.author_id, t.content, t.parent_id, t.group_id, t.topic_day_id,\n        t.visibility, t.attachments, t.likes, t.dislikes, t.created_at, t.updated_at,\n        u.username, u.display_name, u.avatar\n      FROM threads t\n      JOIN users u ON t.author_id = u.id\n      WHERE t.parent_id = ?\n      ORDER BY t.created_at ASC\n    `, [\n            parentId\n        ]);\n        return result.rows.map((thread)=>({\n                ...thread,\n                likes: JSON.parse(thread.likes || \"[]\"),\n                dislikes: JSON.parse(thread.dislikes || \"[]\"),\n                attachments: JSON.parse(thread.attachments || \"[]\"),\n                author: {\n                    id: thread.author_id,\n                    username: thread.username,\n                    displayName: thread.display_name,\n                    avatar: thread.avatar\n                }\n            }));\n    } catch (error) {\n        console.error(\"Error getting thread replies:\", error);\n        throw error;\n    }\n};\nconst updateThread = async (id, updateData)=>{\n    try {\n        const { content, visibility, attachments } = updateData;\n        await db.query(`\n      UPDATE threads \n      SET content = COALESCE(?, content),\n          visibility = COALESCE(?, visibility),\n          attachments = COALESCE(?, attachments),\n          updated_at = CURRENT_TIMESTAMP\n      WHERE id = ?\n    `, [\n            content,\n            visibility,\n            attachments ? JSON.stringify(attachments) : null,\n            id\n        ]);\n        return await getThreadById(id);\n    } catch (error) {\n        console.error(\"Error updating thread:\", error);\n        throw error;\n    }\n};\nconst deleteThread = async (id)=>{\n    try {\n        await db.query(\"DELETE FROM threads WHERE id = ?\", [\n            id\n        ]);\n        await db.query(\"DELETE FROM threads WHERE parent_id = ?\", [\n            id\n        ]); // Delete replies\n        return true;\n    } catch (error) {\n        console.error(\"Error deleting thread:\", error);\n        throw error;\n    }\n};\nconst likeThread = async (threadId, userId)=>{\n    try {\n        const thread = await getThreadById(threadId);\n        if (!thread) {\n            throw new Error(\"Thread not found\");\n        }\n        let likes = thread.likes || [];\n        let dislikes = thread.dislikes || [];\n        // Remove from dislikes if present\n        dislikes = dislikes.filter((id)=>id !== userId);\n        // Add to likes if not already present\n        if (!likes.includes(userId)) {\n            likes.push(userId);\n        }\n        await db.query(`\n      UPDATE threads \n      SET likes = ?, dislikes = ?, updated_at = CURRENT_TIMESTAMP\n      WHERE id = ?\n    `, [\n            JSON.stringify(likes),\n            JSON.stringify(dislikes),\n            threadId\n        ]);\n        return await getThreadById(threadId);\n    } catch (error) {\n        console.error(\"Error liking thread:\", error);\n        throw error;\n    }\n};\nconst unlikeThread = async (threadId, userId)=>{\n    try {\n        const thread = await getThreadById(threadId);\n        if (!thread) {\n            throw new Error(\"Thread not found\");\n        }\n        let likes = thread.likes || [];\n        // Remove from likes\n        likes = likes.filter((id)=>id !== userId);\n        await db.query(`\n      UPDATE threads \n      SET likes = ?, updated_at = CURRENT_TIMESTAMP\n      WHERE id = ?\n    `, [\n            JSON.stringify(likes),\n            threadId\n        ]);\n        return await getThreadById(threadId);\n    } catch (error) {\n        console.error(\"Error unliking thread:\", error);\n        throw error;\n    }\n};\nconst dislikeThread = async (threadId, userId)=>{\n    try {\n        const thread = await getThreadById(threadId);\n        if (!thread) {\n            throw new Error(\"Thread not found\");\n        }\n        let likes = thread.likes || [];\n        let dislikes = thread.dislikes || [];\n        // Remove from likes if present\n        likes = likes.filter((id)=>id !== userId);\n        // Add to dislikes if not already present\n        if (!dislikes.includes(userId)) {\n            dislikes.push(userId);\n        }\n        await db.query(`\n      UPDATE threads \n      SET likes = ?, dislikes = ?, updated_at = CURRENT_TIMESTAMP\n      WHERE id = ?\n    `, [\n            JSON.stringify(likes),\n            JSON.stringify(dislikes),\n            threadId\n        ]);\n        return await getThreadById(threadId);\n    } catch (error) {\n        console.error(\"Error disliking thread:\", error);\n        throw error;\n    }\n};\nconst undislikeThread = async (threadId, userId)=>{\n    try {\n        const thread = await getThreadById(threadId);\n        if (!thread) {\n            throw new Error(\"Thread not found\");\n        }\n        let dislikes = thread.dislikes || [];\n        // Remove from dislikes\n        dislikes = dislikes.filter((id)=>id !== userId);\n        await db.query(`\n      UPDATE threads \n      SET dislikes = ?, updated_at = CURRENT_TIMESTAMP\n      WHERE id = ?\n    `, [\n            JSON.stringify(dislikes),\n            threadId\n        ]);\n        return await getThreadById(threadId);\n    } catch (error) {\n        console.error(\"Error undisliking thread:\", error);\n        throw error;\n    }\n};\nconst searchThreads = async (query, options = {})=>{\n    const { limit = 50, offset = 0 } = options;\n    try {\n        const result = await db.query(`\n      SELECT \n        t.id, t.author_id, t.content, t.parent_id, t.group_id, t.topic_day_id,\n        t.visibility, t.attachments, t.likes, t.dislikes, t.created_at, t.updated_at,\n        u.username, u.display_name, u.avatar\n      FROM threads t\n      JOIN users u ON t.author_id = u.id\n      WHERE t.content LIKE ? AND t.parent_id IS NULL\n      ORDER BY t.created_at DESC\n      LIMIT ? OFFSET ?\n    `, [\n            `%${query}%`,\n            limit,\n            offset\n        ]);\n        return result.rows.map((thread)=>({\n                ...thread,\n                likes: JSON.parse(thread.likes || \"[]\"),\n                dislikes: JSON.parse(thread.dislikes || \"[]\"),\n                attachments: JSON.parse(thread.attachments || \"[]\"),\n                author: {\n                    id: thread.author_id,\n                    username: thread.username,\n                    displayName: thread.display_name,\n                    avatar: thread.avatar\n                },\n                replies: [],\n                comments: []\n            }));\n    } catch (error) {\n        console.error(\"Error searching threads:\", error);\n        throw error;\n    }\n};\nmodule.exports = {\n    createThread,\n    getThreadById,\n    getAllThreads,\n    getThreadReplies,\n    updateThread,\n    deleteThread,\n    likeThread,\n    unlikeThread,\n    dislikeThread,\n    undislikeThread,\n    searchThreads\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL3RocmVhZHMvZGIuanMiLCJtYXBwaW5ncyI6IjtBQUFBLE1BQU1BLEtBQUtDLG1CQUFPQSxDQUFDO0FBQ25CLE1BQU1DLFNBQVNELG1CQUFPQSxDQUFDO0FBRXZCLG1CQUFtQjtBQUNuQixNQUFNRSxlQUFlLE9BQU9DO0lBQzFCLE1BQU0sRUFBRUMsUUFBUSxFQUFFQyxPQUFPLEVBQUVDLFVBQVUsRUFBRUMsUUFBUSxFQUFFQyxXQUFXLEVBQUVDLE9BQU8sRUFBRUMsVUFBVSxFQUFFLEdBQUdQO0lBRXRGLElBQUk7UUFDRixNQUFNUSxXQUFXVixPQUFPVyxVQUFVO1FBRWxDLE1BQU1iLEdBQUdjLEtBQUssQ0FBQyxDQUFDOzs7SUFHaEIsQ0FBQyxFQUFFO1lBQ0RGO1lBQ0FQO1lBQ0FDO1lBQ0FFLFlBQVk7WUFDWkUsV0FBVztZQUNYQyxjQUFjO1lBQ2RKLGNBQWM7WUFDZFEsS0FBS0MsU0FBUyxDQUFDUCxlQUFlLEVBQUU7U0FDakM7UUFFRCxPQUFPLE1BQU1RLGNBQWNMO0lBQzdCLEVBQUUsT0FBT00sT0FBTztRQUNkQyxRQUFRRCxLQUFLLENBQUMsMEJBQTBCQTtRQUN4QyxNQUFNQTtJQUNSO0FBQ0Y7QUFFQSxNQUFNRCxnQkFBZ0IsT0FBT0c7SUFDM0IsSUFBSTtRQUNGLE1BQU1DLFNBQVMsTUFBTXJCLEdBQUdzQixHQUFHLENBQUMsQ0FBQzs7Ozs7Ozs7SUFRN0IsQ0FBQyxFQUFFO1lBQUNGO1NBQUc7UUFFUCxJQUFJLENBQUNDLE9BQU9FLElBQUksQ0FBQyxFQUFFLEVBQUU7WUFDbkIsT0FBTztRQUNUO1FBRUEsTUFBTUMsU0FBU0gsT0FBT0UsSUFBSSxDQUFDLEVBQUU7UUFDN0IsT0FBTztZQUNMLEdBQUdDLE1BQU07WUFDVEMsT0FBT1YsS0FBS1csS0FBSyxDQUFDRixPQUFPQyxLQUFLLElBQUk7WUFDbENFLFVBQVVaLEtBQUtXLEtBQUssQ0FBQ0YsT0FBT0csUUFBUSxJQUFJO1lBQ3hDbEIsYUFBYU0sS0FBS1csS0FBSyxDQUFDRixPQUFPZixXQUFXLElBQUk7WUFDOUNtQixRQUFRO2dCQUNOUixJQUFJSSxPQUFPSyxTQUFTO2dCQUNwQkMsVUFBVU4sT0FBT00sUUFBUTtnQkFDekJDLGFBQWFQLE9BQU9RLFlBQVk7Z0JBQ2hDQyxRQUFRVCxPQUFPUyxNQUFNO1lBQ3ZCO1FBQ0Y7SUFDRixFQUFFLE9BQU9mLE9BQU87UUFDZEMsUUFBUUQsS0FBSyxDQUFDLCtCQUErQkE7UUFDN0MsTUFBTUE7SUFDUjtBQUNGO0FBRUEsTUFBTWdCLGdCQUFnQixPQUFPQyxVQUFVLENBQUMsQ0FBQztJQUN2QyxNQUFNLEVBQUVDLFFBQVEsRUFBRSxFQUFFQyxTQUFTLENBQUMsRUFBRUMsU0FBUyxJQUFJLEVBQUUsR0FBR0g7SUFFbEQsSUFBSTtRQUNGLElBQUlyQixRQUFRLENBQUM7Ozs7Ozs7O0lBUWIsQ0FBQztRQUVELE1BQU15QixTQUFTLEVBQUU7UUFFakIsSUFBSUQsUUFBUTtZQUNWeEIsU0FBUztZQUNUeUIsT0FBT0MsSUFBSSxDQUFDRjtRQUNkO1FBRUF4QixTQUFTO1FBQ1R5QixPQUFPQyxJQUFJLENBQUNKLE9BQU9DO1FBRW5CLE1BQU1oQixTQUFTLE1BQU1yQixHQUFHYyxLQUFLLENBQUNBLE9BQU95QjtRQUVyQyxNQUFNRSxVQUFVcEIsT0FBT0UsSUFBSSxDQUFDbUIsR0FBRyxDQUFDbEIsQ0FBQUEsU0FBVztnQkFDekMsR0FBR0EsTUFBTTtnQkFDVEMsT0FBT1YsS0FBS1csS0FBSyxDQUFDRixPQUFPQyxLQUFLLElBQUk7Z0JBQ2xDRSxVQUFVWixLQUFLVyxLQUFLLENBQUNGLE9BQU9HLFFBQVEsSUFBSTtnQkFDeENsQixhQUFhTSxLQUFLVyxLQUFLLENBQUNGLE9BQU9mLFdBQVcsSUFBSTtnQkFDOUNtQixRQUFRO29CQUNOUixJQUFJSSxPQUFPSyxTQUFTO29CQUNwQkMsVUFBVU4sT0FBT00sUUFBUTtvQkFDekJDLGFBQWFQLE9BQU9RLFlBQVk7b0JBQ2hDQyxRQUFRVCxPQUFPUyxNQUFNO2dCQUN2QjtnQkFDQVUsU0FBUyxFQUFFO2dCQUNYQyxVQUFVLEVBQUU7WUFDZDtRQUVBLDhCQUE4QjtRQUM5QixLQUFLLE1BQU1wQixVQUFVaUIsUUFBUztZQUM1QixNQUFNRSxVQUFVLE1BQU1FLGlCQUFpQnJCLE9BQU9KLEVBQUU7WUFDaERJLE9BQU9tQixPQUFPLEdBQUdBO1FBQ25CO1FBRUEsT0FBT0Y7SUFDVCxFQUFFLE9BQU92QixPQUFPO1FBQ2RDLFFBQVFELEtBQUssQ0FBQyw4QkFBOEJBO1FBQzVDLE1BQU1BO0lBQ1I7QUFDRjtBQUVBLE1BQU0yQixtQkFBbUIsT0FBT3JDO0lBQzlCLElBQUk7UUFDRixNQUFNYSxTQUFTLE1BQU1yQixHQUFHYyxLQUFLLENBQUMsQ0FBQzs7Ozs7Ozs7O0lBUy9CLENBQUMsRUFBRTtZQUFDTjtTQUFTO1FBRWIsT0FBT2EsT0FBT0UsSUFBSSxDQUFDbUIsR0FBRyxDQUFDbEIsQ0FBQUEsU0FBVztnQkFDaEMsR0FBR0EsTUFBTTtnQkFDVEMsT0FBT1YsS0FBS1csS0FBSyxDQUFDRixPQUFPQyxLQUFLLElBQUk7Z0JBQ2xDRSxVQUFVWixLQUFLVyxLQUFLLENBQUNGLE9BQU9HLFFBQVEsSUFBSTtnQkFDeENsQixhQUFhTSxLQUFLVyxLQUFLLENBQUNGLE9BQU9mLFdBQVcsSUFBSTtnQkFDOUNtQixRQUFRO29CQUNOUixJQUFJSSxPQUFPSyxTQUFTO29CQUNwQkMsVUFBVU4sT0FBT00sUUFBUTtvQkFDekJDLGFBQWFQLE9BQU9RLFlBQVk7b0JBQ2hDQyxRQUFRVCxPQUFPUyxNQUFNO2dCQUN2QjtZQUNGO0lBQ0YsRUFBRSxPQUFPZixPQUFPO1FBQ2RDLFFBQVFELEtBQUssQ0FBQyxpQ0FBaUNBO1FBQy9DLE1BQU1BO0lBQ1I7QUFDRjtBQUVBLE1BQU00QixlQUFlLE9BQU8xQixJQUFJMkI7SUFDOUIsSUFBSTtRQUNGLE1BQU0sRUFBRXpDLE9BQU8sRUFBRUMsVUFBVSxFQUFFRSxXQUFXLEVBQUUsR0FBR3NDO1FBRTdDLE1BQU0vQyxHQUFHYyxLQUFLLENBQUMsQ0FBQzs7Ozs7OztJQU9oQixDQUFDLEVBQUU7WUFBQ1I7WUFBU0M7WUFBWUUsY0FBY00sS0FBS0MsU0FBUyxDQUFDUCxlQUFlO1lBQU1XO1NBQUc7UUFFOUUsT0FBTyxNQUFNSCxjQUFjRztJQUM3QixFQUFFLE9BQU9GLE9BQU87UUFDZEMsUUFBUUQsS0FBSyxDQUFDLDBCQUEwQkE7UUFDeEMsTUFBTUE7SUFDUjtBQUNGO0FBRUEsTUFBTThCLGVBQWUsT0FBTzVCO0lBQzFCLElBQUk7UUFDRixNQUFNcEIsR0FBR2MsS0FBSyxDQUFDLG9DQUFvQztZQUFDTTtTQUFHO1FBQ3ZELE1BQU1wQixHQUFHYyxLQUFLLENBQUMsMkNBQTJDO1lBQUNNO1NBQUcsR0FBRyxpQkFBaUI7UUFDbEYsT0FBTztJQUNULEVBQUUsT0FBT0YsT0FBTztRQUNkQyxRQUFRRCxLQUFLLENBQUMsMEJBQTBCQTtRQUN4QyxNQUFNQTtJQUNSO0FBQ0Y7QUFFQSxNQUFNK0IsYUFBYSxPQUFPckMsVUFBVTBCO0lBQ2xDLElBQUk7UUFDRixNQUFNZCxTQUFTLE1BQU1QLGNBQWNMO1FBQ25DLElBQUksQ0FBQ1ksUUFBUTtZQUNYLE1BQU0sSUFBSTBCLE1BQU07UUFDbEI7UUFFQSxJQUFJekIsUUFBUUQsT0FBT0MsS0FBSyxJQUFJLEVBQUU7UUFDOUIsSUFBSUUsV0FBV0gsT0FBT0csUUFBUSxJQUFJLEVBQUU7UUFFcEMsa0NBQWtDO1FBQ2xDQSxXQUFXQSxTQUFTd0IsTUFBTSxDQUFDL0IsQ0FBQUEsS0FBTUEsT0FBT2tCO1FBRXhDLHNDQUFzQztRQUN0QyxJQUFJLENBQUNiLE1BQU0yQixRQUFRLENBQUNkLFNBQVM7WUFDM0JiLE1BQU1lLElBQUksQ0FBQ0Y7UUFDYjtRQUVBLE1BQU10QyxHQUFHYyxLQUFLLENBQUMsQ0FBQzs7OztJQUloQixDQUFDLEVBQUU7WUFBQ0MsS0FBS0MsU0FBUyxDQUFDUztZQUFRVixLQUFLQyxTQUFTLENBQUNXO1lBQVdmO1NBQVM7UUFFOUQsT0FBTyxNQUFNSyxjQUFjTDtJQUM3QixFQUFFLE9BQU9NLE9BQU87UUFDZEMsUUFBUUQsS0FBSyxDQUFDLHdCQUF3QkE7UUFDdEMsTUFBTUE7SUFDUjtBQUNGO0FBRUEsTUFBTW1DLGVBQWUsT0FBT3pDLFVBQVUwQjtJQUNwQyxJQUFJO1FBQ0YsTUFBTWQsU0FBUyxNQUFNUCxjQUFjTDtRQUNuQyxJQUFJLENBQUNZLFFBQVE7WUFDWCxNQUFNLElBQUkwQixNQUFNO1FBQ2xCO1FBRUEsSUFBSXpCLFFBQVFELE9BQU9DLEtBQUssSUFBSSxFQUFFO1FBRTlCLG9CQUFvQjtRQUNwQkEsUUFBUUEsTUFBTTBCLE1BQU0sQ0FBQy9CLENBQUFBLEtBQU1BLE9BQU9rQjtRQUVsQyxNQUFNdEMsR0FBR2MsS0FBSyxDQUFDLENBQUM7Ozs7SUFJaEIsQ0FBQyxFQUFFO1lBQUNDLEtBQUtDLFNBQVMsQ0FBQ1M7WUFBUWI7U0FBUztRQUVwQyxPQUFPLE1BQU1LLGNBQWNMO0lBQzdCLEVBQUUsT0FBT00sT0FBTztRQUNkQyxRQUFRRCxLQUFLLENBQUMsMEJBQTBCQTtRQUN4QyxNQUFNQTtJQUNSO0FBQ0Y7QUFFQSxNQUFNb0MsZ0JBQWdCLE9BQU8xQyxVQUFVMEI7SUFDckMsSUFBSTtRQUNGLE1BQU1kLFNBQVMsTUFBTVAsY0FBY0w7UUFDbkMsSUFBSSxDQUFDWSxRQUFRO1lBQ1gsTUFBTSxJQUFJMEIsTUFBTTtRQUNsQjtRQUVBLElBQUl6QixRQUFRRCxPQUFPQyxLQUFLLElBQUksRUFBRTtRQUM5QixJQUFJRSxXQUFXSCxPQUFPRyxRQUFRLElBQUksRUFBRTtRQUVwQywrQkFBK0I7UUFDL0JGLFFBQVFBLE1BQU0wQixNQUFNLENBQUMvQixDQUFBQSxLQUFNQSxPQUFPa0I7UUFFbEMseUNBQXlDO1FBQ3pDLElBQUksQ0FBQ1gsU0FBU3lCLFFBQVEsQ0FBQ2QsU0FBUztZQUM5QlgsU0FBU2EsSUFBSSxDQUFDRjtRQUNoQjtRQUVBLE1BQU10QyxHQUFHYyxLQUFLLENBQUMsQ0FBQzs7OztJQUloQixDQUFDLEVBQUU7WUFBQ0MsS0FBS0MsU0FBUyxDQUFDUztZQUFRVixLQUFLQyxTQUFTLENBQUNXO1lBQVdmO1NBQVM7UUFFOUQsT0FBTyxNQUFNSyxjQUFjTDtJQUM3QixFQUFFLE9BQU9NLE9BQU87UUFDZEMsUUFBUUQsS0FBSyxDQUFDLDJCQUEyQkE7UUFDekMsTUFBTUE7SUFDUjtBQUNGO0FBRUEsTUFBTXFDLGtCQUFrQixPQUFPM0MsVUFBVTBCO0lBQ3ZDLElBQUk7UUFDRixNQUFNZCxTQUFTLE1BQU1QLGNBQWNMO1FBQ25DLElBQUksQ0FBQ1ksUUFBUTtZQUNYLE1BQU0sSUFBSTBCLE1BQU07UUFDbEI7UUFFQSxJQUFJdkIsV0FBV0gsT0FBT0csUUFBUSxJQUFJLEVBQUU7UUFFcEMsdUJBQXVCO1FBQ3ZCQSxXQUFXQSxTQUFTd0IsTUFBTSxDQUFDL0IsQ0FBQUEsS0FBTUEsT0FBT2tCO1FBRXhDLE1BQU10QyxHQUFHYyxLQUFLLENBQUMsQ0FBQzs7OztJQUloQixDQUFDLEVBQUU7WUFBQ0MsS0FBS0MsU0FBUyxDQUFDVztZQUFXZjtTQUFTO1FBRXZDLE9BQU8sTUFBTUssY0FBY0w7SUFDN0IsRUFBRSxPQUFPTSxPQUFPO1FBQ2RDLFFBQVFELEtBQUssQ0FBQyw2QkFBNkJBO1FBQzNDLE1BQU1BO0lBQ1I7QUFDRjtBQUVBLE1BQU1zQyxnQkFBZ0IsT0FBTzFDLE9BQU9xQixVQUFVLENBQUMsQ0FBQztJQUM5QyxNQUFNLEVBQUVDLFFBQVEsRUFBRSxFQUFFQyxTQUFTLENBQUMsRUFBRSxHQUFHRjtJQUVuQyxJQUFJO1FBQ0YsTUFBTWQsU0FBUyxNQUFNckIsR0FBR2MsS0FBSyxDQUFDLENBQUM7Ozs7Ozs7Ozs7SUFVL0IsQ0FBQyxFQUFFO1lBQUMsQ0FBQyxDQUFDLEVBQUVBLE1BQU0sQ0FBQyxDQUFDO1lBQUVzQjtZQUFPQztTQUFPO1FBRWhDLE9BQU9oQixPQUFPRSxJQUFJLENBQUNtQixHQUFHLENBQUNsQixDQUFBQSxTQUFXO2dCQUNoQyxHQUFHQSxNQUFNO2dCQUNUQyxPQUFPVixLQUFLVyxLQUFLLENBQUNGLE9BQU9DLEtBQUssSUFBSTtnQkFDbENFLFVBQVVaLEtBQUtXLEtBQUssQ0FBQ0YsT0FBT0csUUFBUSxJQUFJO2dCQUN4Q2xCLGFBQWFNLEtBQUtXLEtBQUssQ0FBQ0YsT0FBT2YsV0FBVyxJQUFJO2dCQUM5Q21CLFFBQVE7b0JBQ05SLElBQUlJLE9BQU9LLFNBQVM7b0JBQ3BCQyxVQUFVTixPQUFPTSxRQUFRO29CQUN6QkMsYUFBYVAsT0FBT1EsWUFBWTtvQkFDaENDLFFBQVFULE9BQU9TLE1BQU07Z0JBQ3ZCO2dCQUNBVSxTQUFTLEVBQUU7Z0JBQ1hDLFVBQVUsRUFBRTtZQUNkO0lBQ0YsRUFBRSxPQUFPMUIsT0FBTztRQUNkQyxRQUFRRCxLQUFLLENBQUMsNEJBQTRCQTtRQUMxQyxNQUFNQTtJQUNSO0FBQ0Y7QUFFQXVDLE9BQU9DLE9BQU8sR0FBRztJQUNmdkQ7SUFDQWM7SUFDQWlCO0lBQ0FXO0lBQ0FDO0lBQ0FFO0lBQ0FDO0lBQ0FJO0lBQ0FDO0lBQ0FDO0lBQ0FDO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90aHJlYWRzLWFwcC1iZWV0Ly4vYXBwL2FwaS90aHJlYWRzL2RiLmpzP2YzM2IiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZGIgPSByZXF1aXJlKCcuLi8uLi8uLi9kYXRhYmFzZS9kYicpO1xuY29uc3QgY3J5cHRvID0gcmVxdWlyZSgnY3J5cHRvJyk7XG5cbi8vIFRocmVhZCBmdW5jdGlvbnNcbmNvbnN0IGNyZWF0ZVRocmVhZCA9IGFzeW5jICh0aHJlYWREYXRhKSA9PiB7XG4gIGNvbnN0IHsgYXV0aG9ySWQsIGNvbnRlbnQsIHZpc2liaWxpdHksIHBhcmVudElkLCBhdHRhY2htZW50cywgZ3JvdXBJZCwgdG9waWNEYXlJZCB9ID0gdGhyZWFkRGF0YTtcbiAgXG4gIHRyeSB7XG4gICAgY29uc3QgdGhyZWFkSWQgPSBjcnlwdG8ucmFuZG9tVVVJRCgpO1xuICAgIFxuICAgIGF3YWl0IGRiLnF1ZXJ5KGBcbiAgICAgIElOU0VSVCBJTlRPIHRocmVhZHMgKGlkLCBhdXRob3JfaWQsIGNvbnRlbnQsIHBhcmVudF9pZCwgZ3JvdXBfaWQsIHRvcGljX2RheV9pZCwgdmlzaWJpbGl0eSwgYXR0YWNobWVudHMpXG4gICAgICBWQUxVRVMgKD8sID8sID8sID8sID8sID8sID8sID8pXG4gICAgYCwgW1xuICAgICAgdGhyZWFkSWQsIFxuICAgICAgYXV0aG9ySWQsIFxuICAgICAgY29udGVudCwgXG4gICAgICBwYXJlbnRJZCB8fCBudWxsLCBcbiAgICAgIGdyb3VwSWQgfHwgbnVsbCwgXG4gICAgICB0b3BpY0RheUlkIHx8IG51bGwsIFxuICAgICAgdmlzaWJpbGl0eSB8fCAncHVibGljJywgXG4gICAgICBKU09OLnN0cmluZ2lmeShhdHRhY2htZW50cyB8fCBbXSlcbiAgICBdKTtcbiAgICBcbiAgICByZXR1cm4gYXdhaXQgZ2V0VGhyZWFkQnlJZCh0aHJlYWRJZCk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgdGhyZWFkOicsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxufTtcblxuY29uc3QgZ2V0VGhyZWFkQnlJZCA9IGFzeW5jIChpZCkgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLmdldChgXG4gICAgICBTRUxFQ1QgXG4gICAgICAgIHQuaWQsIHQuYXV0aG9yX2lkLCB0LmNvbnRlbnQsIHQucGFyZW50X2lkLCB0Lmdyb3VwX2lkLCB0LnRvcGljX2RheV9pZCxcbiAgICAgICAgdC52aXNpYmlsaXR5LCB0LmF0dGFjaG1lbnRzLCB0Lmxpa2VzLCB0LmRpc2xpa2VzLCB0LmNyZWF0ZWRfYXQsIHQudXBkYXRlZF9hdCxcbiAgICAgICAgdS51c2VybmFtZSwgdS5kaXNwbGF5X25hbWUsIHUuYXZhdGFyXG4gICAgICBGUk9NIHRocmVhZHMgdFxuICAgICAgSk9JTiB1c2VycyB1IE9OIHQuYXV0aG9yX2lkID0gdS5pZFxuICAgICAgV0hFUkUgdC5pZCA9ID9cbiAgICBgLCBbaWRdKTtcbiAgICBcbiAgICBpZiAoIXJlc3VsdC5yb3dzWzBdKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgXG4gICAgY29uc3QgdGhyZWFkID0gcmVzdWx0LnJvd3NbMF07XG4gICAgcmV0dXJuIHtcbiAgICAgIC4uLnRocmVhZCxcbiAgICAgIGxpa2VzOiBKU09OLnBhcnNlKHRocmVhZC5saWtlcyB8fCAnW10nKSxcbiAgICAgIGRpc2xpa2VzOiBKU09OLnBhcnNlKHRocmVhZC5kaXNsaWtlcyB8fCAnW10nKSxcbiAgICAgIGF0dGFjaG1lbnRzOiBKU09OLnBhcnNlKHRocmVhZC5hdHRhY2htZW50cyB8fCAnW10nKSxcbiAgICAgIGF1dGhvcjoge1xuICAgICAgICBpZDogdGhyZWFkLmF1dGhvcl9pZCxcbiAgICAgICAgdXNlcm5hbWU6IHRocmVhZC51c2VybmFtZSxcbiAgICAgICAgZGlzcGxheU5hbWU6IHRocmVhZC5kaXNwbGF5X25hbWUsXG4gICAgICAgIGF2YXRhcjogdGhyZWFkLmF2YXRhclxuICAgICAgfVxuICAgIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZ2V0dGluZyB0aHJlYWQgYnkgSUQ6JywgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xuICB9XG59O1xuXG5jb25zdCBnZXRBbGxUaHJlYWRzID0gYXN5bmMgKG9wdGlvbnMgPSB7fSkgPT4ge1xuICBjb25zdCB7IGxpbWl0ID0gNTAsIG9mZnNldCA9IDAsIHVzZXJJZCA9IG51bGwgfSA9IG9wdGlvbnM7XG4gIFxuICB0cnkge1xuICAgIGxldCBxdWVyeSA9IGBcbiAgICAgIFNFTEVDVCBcbiAgICAgICAgdC5pZCwgdC5hdXRob3JfaWQsIHQuY29udGVudCwgdC5wYXJlbnRfaWQsIHQuZ3JvdXBfaWQsIHQudG9waWNfZGF5X2lkLFxuICAgICAgICB0LnZpc2liaWxpdHksIHQuYXR0YWNobWVudHMsIHQubGlrZXMsIHQuZGlzbGlrZXMsIHQuY3JlYXRlZF9hdCwgdC51cGRhdGVkX2F0LFxuICAgICAgICB1LnVzZXJuYW1lLCB1LmRpc3BsYXlfbmFtZSwgdS5hdmF0YXJcbiAgICAgIEZST00gdGhyZWFkcyB0XG4gICAgICBKT0lOIHVzZXJzIHUgT04gdC5hdXRob3JfaWQgPSB1LmlkXG4gICAgICBXSEVSRSB0LnBhcmVudF9pZCBJUyBOVUxMXG4gICAgYDtcbiAgICBcbiAgICBjb25zdCBwYXJhbXMgPSBbXTtcbiAgICBcbiAgICBpZiAodXNlcklkKSB7XG4gICAgICBxdWVyeSArPSAnIEFORCB0LmF1dGhvcl9pZCA9ID8nO1xuICAgICAgcGFyYW1zLnB1c2godXNlcklkKTtcbiAgICB9XG4gICAgXG4gICAgcXVlcnkgKz0gJyBPUkRFUiBCWSB0LmNyZWF0ZWRfYXQgREVTQyBMSU1JVCA/IE9GRlNFVCA/JztcbiAgICBwYXJhbXMucHVzaChsaW1pdCwgb2Zmc2V0KTtcbiAgICBcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5xdWVyeShxdWVyeSwgcGFyYW1zKTtcbiAgICBcbiAgICBjb25zdCB0aHJlYWRzID0gcmVzdWx0LnJvd3MubWFwKHRocmVhZCA9PiAoe1xuICAgICAgLi4udGhyZWFkLFxuICAgICAgbGlrZXM6IEpTT04ucGFyc2UodGhyZWFkLmxpa2VzIHx8ICdbXScpLFxuICAgICAgZGlzbGlrZXM6IEpTT04ucGFyc2UodGhyZWFkLmRpc2xpa2VzIHx8ICdbXScpLFxuICAgICAgYXR0YWNobWVudHM6IEpTT04ucGFyc2UodGhyZWFkLmF0dGFjaG1lbnRzIHx8ICdbXScpLFxuICAgICAgYXV0aG9yOiB7XG4gICAgICAgIGlkOiB0aHJlYWQuYXV0aG9yX2lkLFxuICAgICAgICB1c2VybmFtZTogdGhyZWFkLnVzZXJuYW1lLFxuICAgICAgICBkaXNwbGF5TmFtZTogdGhyZWFkLmRpc3BsYXlfbmFtZSxcbiAgICAgICAgYXZhdGFyOiB0aHJlYWQuYXZhdGFyXG4gICAgICB9LFxuICAgICAgcmVwbGllczogW10sXG4gICAgICBjb21tZW50czogW11cbiAgICB9KSk7XG4gICAgXG4gICAgLy8gR2V0IHJlcGxpZXMgZm9yIGVhY2ggdGhyZWFkXG4gICAgZm9yIChjb25zdCB0aHJlYWQgb2YgdGhyZWFkcykge1xuICAgICAgY29uc3QgcmVwbGllcyA9IGF3YWl0IGdldFRocmVhZFJlcGxpZXModGhyZWFkLmlkKTtcbiAgICAgIHRocmVhZC5yZXBsaWVzID0gcmVwbGllcztcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHRocmVhZHM7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZ2V0dGluZyBhbGwgdGhyZWFkczonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn07XG5cbmNvbnN0IGdldFRocmVhZFJlcGxpZXMgPSBhc3luYyAocGFyZW50SWQpID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5xdWVyeShgXG4gICAgICBTRUxFQ1QgXG4gICAgICAgIHQuaWQsIHQuYXV0aG9yX2lkLCB0LmNvbnRlbnQsIHQucGFyZW50X2lkLCB0Lmdyb3VwX2lkLCB0LnRvcGljX2RheV9pZCxcbiAgICAgICAgdC52aXNpYmlsaXR5LCB0LmF0dGFjaG1lbnRzLCB0Lmxpa2VzLCB0LmRpc2xpa2VzLCB0LmNyZWF0ZWRfYXQsIHQudXBkYXRlZF9hdCxcbiAgICAgICAgdS51c2VybmFtZSwgdS5kaXNwbGF5X25hbWUsIHUuYXZhdGFyXG4gICAgICBGUk9NIHRocmVhZHMgdFxuICAgICAgSk9JTiB1c2VycyB1IE9OIHQuYXV0aG9yX2lkID0gdS5pZFxuICAgICAgV0hFUkUgdC5wYXJlbnRfaWQgPSA/XG4gICAgICBPUkRFUiBCWSB0LmNyZWF0ZWRfYXQgQVNDXG4gICAgYCwgW3BhcmVudElkXSk7XG4gICAgXG4gICAgcmV0dXJuIHJlc3VsdC5yb3dzLm1hcCh0aHJlYWQgPT4gKHtcbiAgICAgIC4uLnRocmVhZCxcbiAgICAgIGxpa2VzOiBKU09OLnBhcnNlKHRocmVhZC5saWtlcyB8fCAnW10nKSxcbiAgICAgIGRpc2xpa2VzOiBKU09OLnBhcnNlKHRocmVhZC5kaXNsaWtlcyB8fCAnW10nKSxcbiAgICAgIGF0dGFjaG1lbnRzOiBKU09OLnBhcnNlKHRocmVhZC5hdHRhY2htZW50cyB8fCAnW10nKSxcbiAgICAgIGF1dGhvcjoge1xuICAgICAgICBpZDogdGhyZWFkLmF1dGhvcl9pZCxcbiAgICAgICAgdXNlcm5hbWU6IHRocmVhZC51c2VybmFtZSxcbiAgICAgICAgZGlzcGxheU5hbWU6IHRocmVhZC5kaXNwbGF5X25hbWUsXG4gICAgICAgIGF2YXRhcjogdGhyZWFkLmF2YXRhclxuICAgICAgfVxuICAgIH0pKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZXR0aW5nIHRocmVhZCByZXBsaWVzOicsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxufTtcblxuY29uc3QgdXBkYXRlVGhyZWFkID0gYXN5bmMgKGlkLCB1cGRhdGVEYXRhKSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgeyBjb250ZW50LCB2aXNpYmlsaXR5LCBhdHRhY2htZW50cyB9ID0gdXBkYXRlRGF0YTtcbiAgICBcbiAgICBhd2FpdCBkYi5xdWVyeShgXG4gICAgICBVUERBVEUgdGhyZWFkcyBcbiAgICAgIFNFVCBjb250ZW50ID0gQ09BTEVTQ0UoPywgY29udGVudCksXG4gICAgICAgICAgdmlzaWJpbGl0eSA9IENPQUxFU0NFKD8sIHZpc2liaWxpdHkpLFxuICAgICAgICAgIGF0dGFjaG1lbnRzID0gQ09BTEVTQ0UoPywgYXR0YWNobWVudHMpLFxuICAgICAgICAgIHVwZGF0ZWRfYXQgPSBDVVJSRU5UX1RJTUVTVEFNUFxuICAgICAgV0hFUkUgaWQgPSA/XG4gICAgYCwgW2NvbnRlbnQsIHZpc2liaWxpdHksIGF0dGFjaG1lbnRzID8gSlNPTi5zdHJpbmdpZnkoYXR0YWNobWVudHMpIDogbnVsbCwgaWRdKTtcbiAgICBcbiAgICByZXR1cm4gYXdhaXQgZ2V0VGhyZWFkQnlJZChpZCk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgdGhyZWFkOicsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxufTtcblxuY29uc3QgZGVsZXRlVGhyZWFkID0gYXN5bmMgKGlkKSA9PiB7XG4gIHRyeSB7XG4gICAgYXdhaXQgZGIucXVlcnkoJ0RFTEVURSBGUk9NIHRocmVhZHMgV0hFUkUgaWQgPSA/JywgW2lkXSk7XG4gICAgYXdhaXQgZGIucXVlcnkoJ0RFTEVURSBGUk9NIHRocmVhZHMgV0hFUkUgcGFyZW50X2lkID0gPycsIFtpZF0pOyAvLyBEZWxldGUgcmVwbGllc1xuICAgIHJldHVybiB0cnVlO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIHRocmVhZDonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn07XG5cbmNvbnN0IGxpa2VUaHJlYWQgPSBhc3luYyAodGhyZWFkSWQsIHVzZXJJZCkgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHRocmVhZCA9IGF3YWl0IGdldFRocmVhZEJ5SWQodGhyZWFkSWQpO1xuICAgIGlmICghdGhyZWFkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RocmVhZCBub3QgZm91bmQnKTtcbiAgICB9XG4gICAgXG4gICAgbGV0IGxpa2VzID0gdGhyZWFkLmxpa2VzIHx8IFtdO1xuICAgIGxldCBkaXNsaWtlcyA9IHRocmVhZC5kaXNsaWtlcyB8fCBbXTtcbiAgICBcbiAgICAvLyBSZW1vdmUgZnJvbSBkaXNsaWtlcyBpZiBwcmVzZW50XG4gICAgZGlzbGlrZXMgPSBkaXNsaWtlcy5maWx0ZXIoaWQgPT4gaWQgIT09IHVzZXJJZCk7XG4gICAgXG4gICAgLy8gQWRkIHRvIGxpa2VzIGlmIG5vdCBhbHJlYWR5IHByZXNlbnRcbiAgICBpZiAoIWxpa2VzLmluY2x1ZGVzKHVzZXJJZCkpIHtcbiAgICAgIGxpa2VzLnB1c2godXNlcklkKTtcbiAgICB9XG4gICAgXG4gICAgYXdhaXQgZGIucXVlcnkoYFxuICAgICAgVVBEQVRFIHRocmVhZHMgXG4gICAgICBTRVQgbGlrZXMgPSA/LCBkaXNsaWtlcyA9ID8sIHVwZGF0ZWRfYXQgPSBDVVJSRU5UX1RJTUVTVEFNUFxuICAgICAgV0hFUkUgaWQgPSA/XG4gICAgYCwgW0pTT04uc3RyaW5naWZ5KGxpa2VzKSwgSlNPTi5zdHJpbmdpZnkoZGlzbGlrZXMpLCB0aHJlYWRJZF0pO1xuICAgIFxuICAgIHJldHVybiBhd2FpdCBnZXRUaHJlYWRCeUlkKHRocmVhZElkKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBsaWtpbmcgdGhyZWFkOicsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxufTtcblxuY29uc3QgdW5saWtlVGhyZWFkID0gYXN5bmMgKHRocmVhZElkLCB1c2VySWQpID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCB0aHJlYWQgPSBhd2FpdCBnZXRUaHJlYWRCeUlkKHRocmVhZElkKTtcbiAgICBpZiAoIXRocmVhZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdUaHJlYWQgbm90IGZvdW5kJyk7XG4gICAgfVxuICAgIFxuICAgIGxldCBsaWtlcyA9IHRocmVhZC5saWtlcyB8fCBbXTtcbiAgICBcbiAgICAvLyBSZW1vdmUgZnJvbSBsaWtlc1xuICAgIGxpa2VzID0gbGlrZXMuZmlsdGVyKGlkID0+IGlkICE9PSB1c2VySWQpO1xuICAgIFxuICAgIGF3YWl0IGRiLnF1ZXJ5KGBcbiAgICAgIFVQREFURSB0aHJlYWRzIFxuICAgICAgU0VUIGxpa2VzID0gPywgdXBkYXRlZF9hdCA9IENVUlJFTlRfVElNRVNUQU1QXG4gICAgICBXSEVSRSBpZCA9ID9cbiAgICBgLCBbSlNPTi5zdHJpbmdpZnkobGlrZXMpLCB0aHJlYWRJZF0pO1xuICAgIFxuICAgIHJldHVybiBhd2FpdCBnZXRUaHJlYWRCeUlkKHRocmVhZElkKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1bmxpa2luZyB0aHJlYWQ6JywgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xuICB9XG59O1xuXG5jb25zdCBkaXNsaWtlVGhyZWFkID0gYXN5bmMgKHRocmVhZElkLCB1c2VySWQpID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCB0aHJlYWQgPSBhd2FpdCBnZXRUaHJlYWRCeUlkKHRocmVhZElkKTtcbiAgICBpZiAoIXRocmVhZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdUaHJlYWQgbm90IGZvdW5kJyk7XG4gICAgfVxuICAgIFxuICAgIGxldCBsaWtlcyA9IHRocmVhZC5saWtlcyB8fCBbXTtcbiAgICBsZXQgZGlzbGlrZXMgPSB0aHJlYWQuZGlzbGlrZXMgfHwgW107XG4gICAgXG4gICAgLy8gUmVtb3ZlIGZyb20gbGlrZXMgaWYgcHJlc2VudFxuICAgIGxpa2VzID0gbGlrZXMuZmlsdGVyKGlkID0+IGlkICE9PSB1c2VySWQpO1xuICAgIFxuICAgIC8vIEFkZCB0byBkaXNsaWtlcyBpZiBub3QgYWxyZWFkeSBwcmVzZW50XG4gICAgaWYgKCFkaXNsaWtlcy5pbmNsdWRlcyh1c2VySWQpKSB7XG4gICAgICBkaXNsaWtlcy5wdXNoKHVzZXJJZCk7XG4gICAgfVxuICAgIFxuICAgIGF3YWl0IGRiLnF1ZXJ5KGBcbiAgICAgIFVQREFURSB0aHJlYWRzIFxuICAgICAgU0VUIGxpa2VzID0gPywgZGlzbGlrZXMgPSA/LCB1cGRhdGVkX2F0ID0gQ1VSUkVOVF9USU1FU1RBTVBcbiAgICAgIFdIRVJFIGlkID0gP1xuICAgIGAsIFtKU09OLnN0cmluZ2lmeShsaWtlcyksIEpTT04uc3RyaW5naWZ5KGRpc2xpa2VzKSwgdGhyZWFkSWRdKTtcbiAgICBcbiAgICByZXR1cm4gYXdhaXQgZ2V0VGhyZWFkQnlJZCh0aHJlYWRJZCk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZGlzbGlraW5nIHRocmVhZDonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn07XG5cbmNvbnN0IHVuZGlzbGlrZVRocmVhZCA9IGFzeW5jICh0aHJlYWRJZCwgdXNlcklkKSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgdGhyZWFkID0gYXdhaXQgZ2V0VGhyZWFkQnlJZCh0aHJlYWRJZCk7XG4gICAgaWYgKCF0aHJlYWQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignVGhyZWFkIG5vdCBmb3VuZCcpO1xuICAgIH1cbiAgICBcbiAgICBsZXQgZGlzbGlrZXMgPSB0aHJlYWQuZGlzbGlrZXMgfHwgW107XG4gICAgXG4gICAgLy8gUmVtb3ZlIGZyb20gZGlzbGlrZXNcbiAgICBkaXNsaWtlcyA9IGRpc2xpa2VzLmZpbHRlcihpZCA9PiBpZCAhPT0gdXNlcklkKTtcbiAgICBcbiAgICBhd2FpdCBkYi5xdWVyeShgXG4gICAgICBVUERBVEUgdGhyZWFkcyBcbiAgICAgIFNFVCBkaXNsaWtlcyA9ID8sIHVwZGF0ZWRfYXQgPSBDVVJSRU5UX1RJTUVTVEFNUFxuICAgICAgV0hFUkUgaWQgPSA/XG4gICAgYCwgW0pTT04uc3RyaW5naWZ5KGRpc2xpa2VzKSwgdGhyZWFkSWRdKTtcbiAgICBcbiAgICByZXR1cm4gYXdhaXQgZ2V0VGhyZWFkQnlJZCh0aHJlYWRJZCk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgdW5kaXNsaWtpbmcgdGhyZWFkOicsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxufTtcblxuY29uc3Qgc2VhcmNoVGhyZWFkcyA9IGFzeW5jIChxdWVyeSwgb3B0aW9ucyA9IHt9KSA9PiB7XG4gIGNvbnN0IHsgbGltaXQgPSA1MCwgb2Zmc2V0ID0gMCB9ID0gb3B0aW9ucztcbiAgXG4gIHRyeSB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIucXVlcnkoYFxuICAgICAgU0VMRUNUIFxuICAgICAgICB0LmlkLCB0LmF1dGhvcl9pZCwgdC5jb250ZW50LCB0LnBhcmVudF9pZCwgdC5ncm91cF9pZCwgdC50b3BpY19kYXlfaWQsXG4gICAgICAgIHQudmlzaWJpbGl0eSwgdC5hdHRhY2htZW50cywgdC5saWtlcywgdC5kaXNsaWtlcywgdC5jcmVhdGVkX2F0LCB0LnVwZGF0ZWRfYXQsXG4gICAgICAgIHUudXNlcm5hbWUsIHUuZGlzcGxheV9uYW1lLCB1LmF2YXRhclxuICAgICAgRlJPTSB0aHJlYWRzIHRcbiAgICAgIEpPSU4gdXNlcnMgdSBPTiB0LmF1dGhvcl9pZCA9IHUuaWRcbiAgICAgIFdIRVJFIHQuY29udGVudCBMSUtFID8gQU5EIHQucGFyZW50X2lkIElTIE5VTExcbiAgICAgIE9SREVSIEJZIHQuY3JlYXRlZF9hdCBERVNDXG4gICAgICBMSU1JVCA/IE9GRlNFVCA/XG4gICAgYCwgW2AlJHtxdWVyeX0lYCwgbGltaXQsIG9mZnNldF0pO1xuICAgIFxuICAgIHJldHVybiByZXN1bHQucm93cy5tYXAodGhyZWFkID0+ICh7XG4gICAgICAuLi50aHJlYWQsXG4gICAgICBsaWtlczogSlNPTi5wYXJzZSh0aHJlYWQubGlrZXMgfHwgJ1tdJyksXG4gICAgICBkaXNsaWtlczogSlNPTi5wYXJzZSh0aHJlYWQuZGlzbGlrZXMgfHwgJ1tdJyksXG4gICAgICBhdHRhY2htZW50czogSlNPTi5wYXJzZSh0aHJlYWQuYXR0YWNobWVudHMgfHwgJ1tdJyksXG4gICAgICBhdXRob3I6IHtcbiAgICAgICAgaWQ6IHRocmVhZC5hdXRob3JfaWQsXG4gICAgICAgIHVzZXJuYW1lOiB0aHJlYWQudXNlcm5hbWUsXG4gICAgICAgIGRpc3BsYXlOYW1lOiB0aHJlYWQuZGlzcGxheV9uYW1lLFxuICAgICAgICBhdmF0YXI6IHRocmVhZC5hdmF0YXJcbiAgICAgIH0sXG4gICAgICByZXBsaWVzOiBbXSxcbiAgICAgIGNvbW1lbnRzOiBbXVxuICAgIH0pKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBzZWFyY2hpbmcgdGhyZWFkczonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICBjcmVhdGVUaHJlYWQsXG4gIGdldFRocmVhZEJ5SWQsXG4gIGdldEFsbFRocmVhZHMsXG4gIGdldFRocmVhZFJlcGxpZXMsXG4gIHVwZGF0ZVRocmVhZCxcbiAgZGVsZXRlVGhyZWFkLFxuICBsaWtlVGhyZWFkLFxuICB1bmxpa2VUaHJlYWQsXG4gIGRpc2xpa2VUaHJlYWQsXG4gIHVuZGlzbGlrZVRocmVhZCxcbiAgc2VhcmNoVGhyZWFkc1xufTtcbiJdLCJuYW1lcyI6WyJkYiIsInJlcXVpcmUiLCJjcnlwdG8iLCJjcmVhdGVUaHJlYWQiLCJ0aHJlYWREYXRhIiwiYXV0aG9ySWQiLCJjb250ZW50IiwidmlzaWJpbGl0eSIsInBhcmVudElkIiwiYXR0YWNobWVudHMiLCJncm91cElkIiwidG9waWNEYXlJZCIsInRocmVhZElkIiwicmFuZG9tVVVJRCIsInF1ZXJ5IiwiSlNPTiIsInN0cmluZ2lmeSIsImdldFRocmVhZEJ5SWQiLCJlcnJvciIsImNvbnNvbGUiLCJpZCIsInJlc3VsdCIsImdldCIsInJvd3MiLCJ0aHJlYWQiLCJsaWtlcyIsInBhcnNlIiwiZGlzbGlrZXMiLCJhdXRob3IiLCJhdXRob3JfaWQiLCJ1c2VybmFtZSIsImRpc3BsYXlOYW1lIiwiZGlzcGxheV9uYW1lIiwiYXZhdGFyIiwiZ2V0QWxsVGhyZWFkcyIsIm9wdGlvbnMiLCJsaW1pdCIsIm9mZnNldCIsInVzZXJJZCIsInBhcmFtcyIsInB1c2giLCJ0aHJlYWRzIiwibWFwIiwicmVwbGllcyIsImNvbW1lbnRzIiwiZ2V0VGhyZWFkUmVwbGllcyIsInVwZGF0ZVRocmVhZCIsInVwZGF0ZURhdGEiLCJkZWxldGVUaHJlYWQiLCJsaWtlVGhyZWFkIiwiRXJyb3IiLCJmaWx0ZXIiLCJpbmNsdWRlcyIsInVubGlrZVRocmVhZCIsImRpc2xpa2VUaHJlYWQiLCJ1bmRpc2xpa2VUaHJlYWQiLCJzZWFyY2hUaHJlYWRzIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./app/api/threads/db.js\n");

/***/ }),

/***/ "(rsc)/./app/api/threads/route.ts":
/*!**********************************!*\
  !*** ./app/api/threads/route.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DELETE: () => (/* binding */ DELETE),\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST),\n/* harmony export */   PUT: () => (/* binding */ PUT)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n\nconst threadsDb = __webpack_require__(/*! ./db */ \"(rsc)/./app/api/threads/db.js\");\nconst authDb = __webpack_require__(/*! ../auth/db */ \"(rsc)/./app/api/auth/db.js\");\n// GET - Get all threads\nasync function GET(request) {\n    try {\n        const { searchParams } = new URL(request.url);\n        const limit = parseInt(searchParams.get(\"limit\") || \"50\");\n        const offset = parseInt(searchParams.get(\"offset\") || \"0\");\n        const userId = searchParams.get(\"userId\");\n        const threads = await threadsDb.getAllThreads({\n            limit,\n            offset,\n            userId: userId || null\n        });\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            threads: threads\n        });\n    } catch (error) {\n        console.error(\"Error fetching threads:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: \"Internal server error\"\n        }, {\n            status: 500\n        });\n    }\n}\n// POST - Create new thread or reply\nasync function POST(request) {\n    try {\n        // Check authentication\n        const authToken = request.cookies.get(\"auth-token\")?.value;\n        if (!authToken) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"Authentication required\"\n            }, {\n                status: 401\n            });\n        }\n        const decoded = authDb.verifyToken(authToken);\n        if (!decoded) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"Invalid or expired token\"\n            }, {\n                status: 401\n            });\n        }\n        const body = await request.json();\n        const { content, visibility, attachments, parentId, groupId, topicDayId } = body;\n        // Validation\n        if (!content || content.trim().length === 0) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"Content is required\"\n            }, {\n                status: 400\n            });\n        }\n        if (content.length > 500) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"Content must be 500 characters or less\"\n            }, {\n                status: 400\n            });\n        }\n        // Create thread or reply\n        const newThread = await threadsDb.createThread({\n            authorId: decoded.id,\n            content: content.trim(),\n            visibility: visibility || \"public\",\n            parentId: parentId || null,\n            attachments: attachments || [],\n            groupId: groupId || null,\n            topicDayId: topicDayId || null\n        });\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            thread: newThread,\n            message: parentId ? \"Reply created successfully\" : \"Thread created successfully\"\n        });\n    } catch (error) {\n        console.error(\"Error creating thread:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: \"Internal server error\"\n        }, {\n            status: 500\n        });\n    }\n}\n// PUT - Like/Unlike thread\nasync function PUT(request) {\n    try {\n        // Check authentication\n        const authToken = request.cookies.get(\"auth-token\")?.value;\n        if (!authToken) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"Authentication required\"\n            }, {\n                status: 401\n            });\n        }\n        const decoded = authDb.verifyToken(authToken);\n        if (!decoded) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"Invalid or expired token\"\n            }, {\n                status: 401\n            });\n        }\n        const body = await request.json();\n        const { threadId, action } = body;\n        if (!threadId || !action) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"Thread ID and action are required\"\n            }, {\n                status: 400\n            });\n        }\n        let result;\n        switch(action){\n            case \"like\":\n                result = await threadsDb.likeThread(threadId, decoded.id);\n                break;\n            case \"unlike\":\n                result = await threadsDb.unlikeThread(threadId, decoded.id);\n                break;\n            case \"dislike\":\n                result = await threadsDb.dislikeThread(threadId, decoded.id);\n                break;\n            case \"undislike\":\n                result = await threadsDb.undislikeThread(threadId, decoded.id);\n                break;\n            default:\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    success: false,\n                    error: \"Invalid action. Use: like, unlike, dislike, or undislike\"\n                }, {\n                    status: 400\n                });\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            thread: result,\n            message: `Thread ${action}d successfully`\n        });\n    } catch (error) {\n        console.error(\"Error updating thread:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: \"Internal server error\"\n        }, {\n            status: 500\n        });\n    }\n}\n// DELETE - Delete thread\nasync function DELETE(request) {\n    try {\n        // Check authentication\n        const authToken = request.cookies.get(\"auth-token\")?.value;\n        if (!authToken) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"Authentication required\"\n            }, {\n                status: 401\n            });\n        }\n        const decoded = authDb.verifyToken(authToken);\n        if (!decoded) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"Invalid or expired token\"\n            }, {\n                status: 401\n            });\n        }\n        const { searchParams } = new URL(request.url);\n        const threadId = searchParams.get(\"id\");\n        if (!threadId) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"Thread ID is required\"\n            }, {\n                status: 400\n            });\n        }\n        // Check if user owns the thread\n        const thread = await threadsDb.getThreadById(threadId);\n        if (!thread) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"Thread not found\"\n            }, {\n                status: 404\n            });\n        }\n        if (thread.author_id !== decoded.id) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"You can only delete your own threads\"\n            }, {\n                status: 403\n            });\n        }\n        await threadsDb.deleteThread(threadId);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            message: \"Thread deleted successfully\"\n        });\n    } catch (error) {\n        console.error(\"Error deleting thread:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: \"Internal server error\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RixRQUFRRyxHQUFHO1FBQzVDLE1BQU1tQyxXQUFXckMsYUFBYUssR0FBRyxDQUFDO1FBRWxDLElBQUksQ0FBQ2dDLFVBQVU7WUFDYixPQUFPM0MscURBQVlBLENBQUNnQixJQUFJLENBQ3RCO2dCQUFFQyxTQUFTO2dCQUFPQyxPQUFPO1lBQXdCLEdBQ2pEO2dCQUFFRSxRQUFRO1lBQUk7UUFFbEI7UUFFQSxnQ0FBZ0M7UUFDaEMsTUFBTW9CLFNBQVMsTUFBTXZDLFVBQVVrRCxhQUFhLENBQUNSO1FBQzdDLElBQUksQ0FBQ0gsUUFBUTtZQUNYLE9BQU94QyxxREFBWUEsQ0FBQ2dCLElBQUksQ0FDdEI7Z0JBQUVDLFNBQVM7Z0JBQU9DLE9BQU87WUFBbUIsR0FDNUM7Z0JBQUVFLFFBQVE7WUFBSTtRQUVsQjtRQUVBLElBQUlvQixPQUFPWSxTQUFTLEtBQUszQixRQUFRYyxFQUFFLEVBQUU7WUFDbkMsT0FBT3ZDLHFEQUFZQSxDQUFDZ0IsSUFBSSxDQUN0QjtnQkFBRUMsU0FBUztnQkFBT0MsT0FBTztZQUF1QyxHQUNoRTtnQkFBRUUsUUFBUTtZQUFJO1FBRWxCO1FBRUEsTUFBTW5CLFVBQVVvRCxZQUFZLENBQUNWO1FBRTdCLE9BQU8zQyxxREFBWUEsQ0FBQ2dCLElBQUksQ0FBQztZQUN2QkMsU0FBUztZQUNUd0IsU0FBUztRQUNYO0lBRUYsRUFBRSxPQUFPdkIsT0FBTztRQUNkQyxRQUFRRCxLQUFLLENBQUMsMEJBQTBCQTtRQUN4QyxPQUFPbEIscURBQVlBLENBQUNnQixJQUFJLENBQ3RCO1lBQUVDLFNBQVM7WUFBT0MsT0FBTztRQUF3QixHQUNqRDtZQUFFRSxRQUFRO1FBQUk7SUFFbEI7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3RocmVhZHMtYXBwLWJlZXQvLi9hcHAvYXBpL3RocmVhZHMvcm91dGUudHM/N2FhNiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xuY29uc3QgdGhyZWFkc0RiID0gcmVxdWlyZSgnLi9kYicpO1xuY29uc3QgYXV0aERiID0gcmVxdWlyZSgnLi4vYXV0aC9kYicpO1xuXG4vLyBHRVQgLSBHZXQgYWxsIHRocmVhZHNcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCB7IHNlYXJjaFBhcmFtcyB9ID0gbmV3IFVSTChyZXF1ZXN0LnVybCk7XG4gICAgY29uc3QgbGltaXQgPSBwYXJzZUludChzZWFyY2hQYXJhbXMuZ2V0KCdsaW1pdCcpIHx8ICc1MCcpO1xuICAgIGNvbnN0IG9mZnNldCA9IHBhcnNlSW50KHNlYXJjaFBhcmFtcy5nZXQoJ29mZnNldCcpIHx8ICcwJyk7XG4gICAgY29uc3QgdXNlcklkID0gc2VhcmNoUGFyYW1zLmdldCgndXNlcklkJyk7XG5cbiAgICBjb25zdCB0aHJlYWRzID0gYXdhaXQgdGhyZWFkc0RiLmdldEFsbFRocmVhZHMoe1xuICAgICAgbGltaXQsXG4gICAgICBvZmZzZXQsXG4gICAgICB1c2VySWQ6IHVzZXJJZCB8fCBudWxsXG4gICAgfSk7XG5cbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIHRocmVhZHM6IHRocmVhZHNcbiAgICB9KTtcblxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHRocmVhZHM6JywgZXJyb3IpO1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnSW50ZXJuYWwgc2VydmVyIGVycm9yJyB9LFxuICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgKTtcbiAgfVxufVxuXG4vLyBQT1NUIC0gQ3JlYXRlIG5ldyB0aHJlYWQgb3IgcmVwbHlcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XG4gIHRyeSB7XG4gICAgLy8gQ2hlY2sgYXV0aGVudGljYXRpb25cbiAgICBjb25zdCBhdXRoVG9rZW4gPSByZXF1ZXN0LmNvb2tpZXMuZ2V0KCdhdXRoLXRva2VuJyk/LnZhbHVlO1xuICAgIGlmICghYXV0aFRva2VuKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnQXV0aGVudGljYXRpb24gcmVxdWlyZWQnIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDEgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgICBjb25zdCBkZWNvZGVkID0gYXV0aERiLnZlcmlmeVRva2VuKGF1dGhUb2tlbik7XG4gICAgaWYgKCFkZWNvZGVkKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnSW52YWxpZCBvciBleHBpcmVkIHRva2VuJyB9LFxuICAgICAgICB7IHN0YXR1czogNDAxIH1cbiAgICAgICk7XG4gICAgfVxuXG4gICAgY29uc3QgYm9keSA9IGF3YWl0IHJlcXVlc3QuanNvbigpO1xuICAgIGNvbnN0IHsgY29udGVudCwgdmlzaWJpbGl0eSwgYXR0YWNobWVudHMsIHBhcmVudElkLCBncm91cElkLCB0b3BpY0RheUlkIH0gPSBib2R5O1xuXG4gICAgLy8gVmFsaWRhdGlvblxuICAgIGlmICghY29udGVudCB8fCBjb250ZW50LnRyaW0oKS5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdDb250ZW50IGlzIHJlcXVpcmVkJyB9LFxuICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgICk7XG4gICAgfVxuXG4gICAgaWYgKGNvbnRlbnQubGVuZ3RoID4gNTAwKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnQ29udGVudCBtdXN0IGJlIDUwMCBjaGFyYWN0ZXJzIG9yIGxlc3MnIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgICAvLyBDcmVhdGUgdGhyZWFkIG9yIHJlcGx5XG4gICAgY29uc3QgbmV3VGhyZWFkID0gYXdhaXQgdGhyZWFkc0RiLmNyZWF0ZVRocmVhZCh7XG4gICAgICBhdXRob3JJZDogZGVjb2RlZC5pZCxcbiAgICAgIGNvbnRlbnQ6IGNvbnRlbnQudHJpbSgpLFxuICAgICAgdmlzaWJpbGl0eTogdmlzaWJpbGl0eSB8fCAncHVibGljJyxcbiAgICAgIHBhcmVudElkOiBwYXJlbnRJZCB8fCBudWxsLFxuICAgICAgYXR0YWNobWVudHM6IGF0dGFjaG1lbnRzIHx8IFtdLFxuICAgICAgZ3JvdXBJZDogZ3JvdXBJZCB8fCBudWxsLFxuICAgICAgdG9waWNEYXlJZDogdG9waWNEYXlJZCB8fCBudWxsXG4gICAgfSk7XG5cbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIHRocmVhZDogbmV3VGhyZWFkLFxuICAgICAgbWVzc2FnZTogcGFyZW50SWQgPyAnUmVwbHkgY3JlYXRlZCBzdWNjZXNzZnVsbHknIDogJ1RocmVhZCBjcmVhdGVkIHN1Y2Nlc3NmdWxseSdcbiAgICB9KTtcblxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIHRocmVhZDonLCBlcnJvcik7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdJbnRlcm5hbCBzZXJ2ZXIgZXJyb3InIH0sXG4gICAgICB7IHN0YXR1czogNTAwIH1cbiAgICApO1xuICB9XG59XG5cbi8vIFBVVCAtIExpa2UvVW5saWtlIHRocmVhZFxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBVVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICB0cnkge1xuICAgIC8vIENoZWNrIGF1dGhlbnRpY2F0aW9uXG4gICAgY29uc3QgYXV0aFRva2VuID0gcmVxdWVzdC5jb29raWVzLmdldCgnYXV0aC10b2tlbicpPy52YWx1ZTtcbiAgICBpZiAoIWF1dGhUb2tlbikge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0F1dGhlbnRpY2F0aW9uIHJlcXVpcmVkJyB9LFxuICAgICAgICB7IHN0YXR1czogNDAxIH1cbiAgICAgICk7XG4gICAgfVxuXG4gICAgY29uc3QgZGVjb2RlZCA9IGF1dGhEYi52ZXJpZnlUb2tlbihhdXRoVG9rZW4pO1xuICAgIGlmICghZGVjb2RlZCkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0ludmFsaWQgb3IgZXhwaXJlZCB0b2tlbicgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMSB9XG4gICAgICApO1xuICAgIH1cblxuICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKTtcbiAgICBjb25zdCB7IHRocmVhZElkLCBhY3Rpb24gfSA9IGJvZHk7XG5cbiAgICBpZiAoIXRocmVhZElkIHx8ICFhY3Rpb24pIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdUaHJlYWQgSUQgYW5kIGFjdGlvbiBhcmUgcmVxdWlyZWQnIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgICBsZXQgcmVzdWx0O1xuICAgIHN3aXRjaCAoYWN0aW9uKSB7XG4gICAgICBjYXNlICdsaWtlJzpcbiAgICAgICAgcmVzdWx0ID0gYXdhaXQgdGhyZWFkc0RiLmxpa2VUaHJlYWQodGhyZWFkSWQsIGRlY29kZWQuaWQpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ3VubGlrZSc6XG4gICAgICAgIHJlc3VsdCA9IGF3YWl0IHRocmVhZHNEYi51bmxpa2VUaHJlYWQodGhyZWFkSWQsIGRlY29kZWQuaWQpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ2Rpc2xpa2UnOlxuICAgICAgICByZXN1bHQgPSBhd2FpdCB0aHJlYWRzRGIuZGlzbGlrZVRocmVhZCh0aHJlYWRJZCwgZGVjb2RlZC5pZCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAndW5kaXNsaWtlJzpcbiAgICAgICAgcmVzdWx0ID0gYXdhaXQgdGhyZWFkc0RiLnVuZGlzbGlrZVRocmVhZCh0aHJlYWRJZCwgZGVjb2RlZC5pZCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnSW52YWxpZCBhY3Rpb24uIFVzZTogbGlrZSwgdW5saWtlLCBkaXNsaWtlLCBvciB1bmRpc2xpa2UnIH0sXG4gICAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICB0aHJlYWQ6IHJlc3VsdCxcbiAgICAgIG1lc3NhZ2U6IGBUaHJlYWQgJHthY3Rpb259ZCBzdWNjZXNzZnVsbHlgXG4gICAgfSk7XG5cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyB0aHJlYWQ6JywgZXJyb3IpO1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnSW50ZXJuYWwgc2VydmVyIGVycm9yJyB9LFxuICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgKTtcbiAgfVxufVxuXG4vLyBERUxFVEUgLSBEZWxldGUgdGhyZWFkXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gREVMRVRFKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XG4gIHRyeSB7XG4gICAgLy8gQ2hlY2sgYXV0aGVudGljYXRpb25cbiAgICBjb25zdCBhdXRoVG9rZW4gPSByZXF1ZXN0LmNvb2tpZXMuZ2V0KCdhdXRoLXRva2VuJyk/LnZhbHVlO1xuICAgIGlmICghYXV0aFRva2VuKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnQXV0aGVudGljYXRpb24gcmVxdWlyZWQnIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDEgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgICBjb25zdCBkZWNvZGVkID0gYXV0aERiLnZlcmlmeVRva2VuKGF1dGhUb2tlbik7XG4gICAgaWYgKCFkZWNvZGVkKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnSW52YWxpZCBvciBleHBpcmVkIHRva2VuJyB9LFxuICAgICAgICB7IHN0YXR1czogNDAxIH1cbiAgICAgICk7XG4gICAgfVxuXG4gICAgY29uc3QgeyBzZWFyY2hQYXJhbXMgfSA9IG5ldyBVUkwocmVxdWVzdC51cmwpO1xuICAgIGNvbnN0IHRocmVhZElkID0gc2VhcmNoUGFyYW1zLmdldCgnaWQnKTtcblxuICAgIGlmICghdGhyZWFkSWQpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdUaHJlYWQgSUQgaXMgcmVxdWlyZWQnIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgICAvLyBDaGVjayBpZiB1c2VyIG93bnMgdGhlIHRocmVhZFxuICAgIGNvbnN0IHRocmVhZCA9IGF3YWl0IHRocmVhZHNEYi5nZXRUaHJlYWRCeUlkKHRocmVhZElkKTtcbiAgICBpZiAoIXRocmVhZCkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ1RocmVhZCBub3QgZm91bmQnIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDQgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgICBpZiAodGhyZWFkLmF1dGhvcl9pZCAhPT0gZGVjb2RlZC5pZCkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ1lvdSBjYW4gb25seSBkZWxldGUgeW91ciBvd24gdGhyZWFkcycgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMyB9XG4gICAgICApO1xuICAgIH1cblxuICAgIGF3YWl0IHRocmVhZHNEYi5kZWxldGVUaHJlYWQodGhyZWFkSWQpO1xuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBtZXNzYWdlOiAnVGhyZWFkIGRlbGV0ZWQgc3VjY2Vzc2Z1bGx5J1xuICAgIH0pO1xuXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVsZXRpbmcgdGhyZWFkOicsIGVycm9yKTtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0ludGVybmFsIHNlcnZlciBlcnJvcicgfSxcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgICk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJ0aHJlYWRzRGIiLCJyZXF1aXJlIiwiYXV0aERiIiwiR0VUIiwicmVxdWVzdCIsInNlYXJjaFBhcmFtcyIsIlVSTCIsInVybCIsImxpbWl0IiwicGFyc2VJbnQiLCJnZXQiLCJvZmZzZXQiLCJ1c2VySWQiLCJ0aHJlYWRzIiwiZ2V0QWxsVGhyZWFkcyIsImpzb24iLCJzdWNjZXNzIiwiZXJyb3IiLCJjb25zb2xlIiwic3RhdHVzIiwiUE9TVCIsImF1dGhUb2tlbiIsImNvb2tpZXMiLCJ2YWx1ZSIsImRlY29kZWQiLCJ2ZXJpZnlUb2tlbiIsImJvZHkiLCJjb250ZW50IiwidmlzaWJpbGl0eSIsImF0dGFjaG1lbnRzIiwicGFyZW50SWQiLCJncm91cElkIiwidG9waWNEYXlJZCIsInRyaW0iLCJsZW5ndGgiLCJuZXdUaHJlYWQiLCJjcmVhdGVUaHJlYWQiLCJhdXRob3JJZCIsImlkIiwidGhyZWFkIiwibWVzc2FnZSIsIlBVVCIsInRocmVhZElkIiwiYWN0aW9uIiwicmVzdWx0IiwibGlrZVRocmVhZCIsInVubGlrZVRocmVhZCIsImRpc2xpa2VUaHJlYWQiLCJ1bmRpc2xpa2VUaHJlYWQiLCJERUxFVEUiLCJnZXRUaHJlYWRCeUlkIiwiYXV0aG9yX2lkIiwiZGVsZXRlVGhyZWFkIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/threads/route.ts\n");

/***/ }),

/***/ "(rsc)/./database/db.js":
/*!************************!*\
  !*** ./database/db.js ***!
  \************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

eval("// Simplified database configuration for SQLite\n\nconst sqlite3 = (__webpack_require__(/*! sqlite3 */ \"sqlite3\").verbose)();\nconst path = __webpack_require__(/*! path */ \"path\");\n// Create database file in project root\nconst dbPath = path.join(process.cwd(), \"threads_app.db\");\n// Create database connection\nlet db = null;\nconst initDatabase = ()=>{\n    if (db) return db;\n    db = new sqlite3.Database(dbPath, (err)=>{\n        if (err) {\n            console.error(\" Error opening database:\", err.message);\n        } else {\n            console.log(\" Connected to SQLite database\");\n        }\n    });\n    // Enable foreign keys\n    db.run(\"PRAGMA foreign_keys = ON\");\n    return db;\n};\n// Database helper functions\nconst database = {\n    // Initialize database connection\n    init: ()=>{\n        return initDatabase();\n    },\n    // Execute a query\n    query: (sql, params = [])=>{\n        const db = initDatabase();\n        return new Promise((resolve, reject)=>{\n            if (sql.trim().toUpperCase().startsWith(\"SELECT\")) {\n                db.all(sql, params, (err, rows)=>{\n                    if (err) {\n                        console.error(\" Database query error:\", err);\n                        reject(err);\n                    } else {\n                        resolve({\n                            success: true,\n                            rows\n                        });\n                    }\n                });\n            } else {\n                db.run(sql, params, function(err) {\n                    if (err) {\n                        console.error(\" Database query error:\", err);\n                        reject(err);\n                    } else {\n                        resolve({\n                            success: true,\n                            rowCount: this.changes,\n                            lastID: this.lastID,\n                            rows: this.lastID ? [\n                                {\n                                    id: this.lastID\n                                }\n                            ] : []\n                        });\n                    }\n                });\n            }\n        });\n    },\n    // Get a single row\n    get: (sql, params = [])=>{\n        const db = initDatabase();\n        return new Promise((resolve, reject)=>{\n            db.get(sql, params, (err, row)=>{\n                if (err) {\n                    console.error(\" Database query error:\", err);\n                    reject(err);\n                } else {\n                    resolve({\n                        success: true,\n                        rows: row ? [\n                            row\n                        ] : []\n                    });\n                }\n            });\n        });\n    },\n    // Close database connection\n    close: ()=>{\n        if (db) {\n            return new Promise((resolve)=>{\n                db.close((err)=>{\n                    if (err) {\n                        console.error(\" Error closing database:\", err.message);\n                    } else {\n                        console.log(\" Database connection closed\");\n                    }\n                    db = null;\n                    resolve();\n                });\n            });\n        }\n        return Promise.resolve();\n    },\n    // Transaction helper\n    transaction: async (callback)=>{\n        const db = initDatabase();\n        try {\n            await database.query(\"BEGIN TRANSACTION\");\n            const result = await callback(database);\n            await database.query(\"COMMIT\");\n            return result;\n        } catch (error) {\n            await database.query(\"ROLLBACK\");\n            throw error;\n        }\n    }\n};\nmodule.exports = database;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QixNQUFNL0IsS0FBS0M7UUFDWCxJQUFJO1lBQ0YsTUFBTVEsU0FBU0UsS0FBSyxDQUFDO1lBQ3JCLE1BQU1xQixTQUFTLE1BQU1ELFNBQVN0QjtZQUM5QixNQUFNQSxTQUFTRSxLQUFLLENBQUM7WUFDckIsT0FBT3FCO1FBQ1QsRUFBRSxPQUFPM0IsT0FBTztZQUNkLE1BQU1JLFNBQVNFLEtBQUssQ0FBQztZQUNyQixNQUFNTjtRQUNSO0lBQ0Y7QUFDRjtBQUVBNEIsT0FBT0MsT0FBTyxHQUFHekIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90aHJlYWRzLWFwcC1iZWV0Ly4vZGF0YWJhc2UvZGIuanM/NjRhNCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBTaW1wbGlmaWVkIGRhdGFiYXNlIGNvbmZpZ3VyYXRpb24gZm9yIFNRTGl0ZVxuY29uc3Qgc3FsaXRlMyA9IHJlcXVpcmUoJ3NxbGl0ZTMnKS52ZXJib3NlKCk7XG5jb25zdCBwYXRoID0gcmVxdWlyZSgncGF0aCcpO1xuXG4vLyBDcmVhdGUgZGF0YWJhc2UgZmlsZSBpbiBwcm9qZWN0IHJvb3RcbmNvbnN0IGRiUGF0aCA9IHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCAndGhyZWFkc19hcHAuZGInKTtcblxuLy8gQ3JlYXRlIGRhdGFiYXNlIGNvbm5lY3Rpb25cbmxldCBkYiA9IG51bGw7XG5cbmNvbnN0IGluaXREYXRhYmFzZSA9ICgpID0+IHtcbiAgaWYgKGRiKSByZXR1cm4gZGI7XG4gIFxuICBkYiA9IG5ldyBzcWxpdGUzLkRhdGFiYXNlKGRiUGF0aCwgKGVycikgPT4ge1xuICAgIGlmIChlcnIpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBFcnJvciBvcGVuaW5nIGRhdGFiYXNlOicsIGVyci5tZXNzYWdlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc29sZS5sb2coJ+KchSBDb25uZWN0ZWQgdG8gU1FMaXRlIGRhdGFiYXNlJyk7XG4gICAgfVxuICB9KTtcblxuICAvLyBFbmFibGUgZm9yZWlnbiBrZXlzXG4gIGRiLnJ1bignUFJBR01BIGZvcmVpZ25fa2V5cyA9IE9OJyk7XG4gIFxuICByZXR1cm4gZGI7XG59O1xuXG4vLyBEYXRhYmFzZSBoZWxwZXIgZnVuY3Rpb25zXG5jb25zdCBkYXRhYmFzZSA9IHtcbiAgLy8gSW5pdGlhbGl6ZSBkYXRhYmFzZSBjb25uZWN0aW9uXG4gIGluaXQ6ICgpID0+IHtcbiAgICByZXR1cm4gaW5pdERhdGFiYXNlKCk7XG4gIH0sXG5cbiAgLy8gRXhlY3V0ZSBhIHF1ZXJ5XG4gIHF1ZXJ5OiAoc3FsLCBwYXJhbXMgPSBbXSkgPT4ge1xuICAgIGNvbnN0IGRiID0gaW5pdERhdGFiYXNlKCk7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIGlmIChzcWwudHJpbSgpLnRvVXBwZXJDYXNlKCkuc3RhcnRzV2l0aCgnU0VMRUNUJykpIHtcbiAgICAgICAgZGIuYWxsKHNxbCwgcGFyYW1zLCAoZXJyLCByb3dzKSA9PiB7XG4gICAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcign4p2MIERhdGFiYXNlIHF1ZXJ5IGVycm9yOicsIGVycik7XG4gICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVzb2x2ZSh7IHN1Y2Nlc3M6IHRydWUsIHJvd3MgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGRiLnJ1bihzcWwsIHBhcmFtcywgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcign4p2MIERhdGFiYXNlIHF1ZXJ5IGVycm9yOicsIGVycik7XG4gICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVzb2x2ZSh7IFxuICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICByb3dDb3VudDogdGhpcy5jaGFuZ2VzLFxuICAgICAgICAgICAgICBsYXN0SUQ6IHRoaXMubGFzdElELFxuICAgICAgICAgICAgICByb3dzOiB0aGlzLmxhc3RJRCA/IFt7IGlkOiB0aGlzLmxhc3RJRCB9XSA6IFtdXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0pO1xuICB9LFxuXG4gIC8vIEdldCBhIHNpbmdsZSByb3dcbiAgZ2V0OiAoc3FsLCBwYXJhbXMgPSBbXSkgPT4ge1xuICAgIGNvbnN0IGRiID0gaW5pdERhdGFiYXNlKCk7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIGRiLmdldChzcWwsIHBhcmFtcywgKGVyciwgcm93KSA9PiB7XG4gICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCfinYwgRGF0YWJhc2UgcXVlcnkgZXJyb3I6JywgZXJyKTtcbiAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXNvbHZlKHsgc3VjY2VzczogdHJ1ZSwgcm93czogcm93ID8gW3Jvd10gOiBbXSB9KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gIH0sXG5cbiAgLy8gQ2xvc2UgZGF0YWJhc2UgY29ubmVjdGlvblxuICBjbG9zZTogKCkgPT4ge1xuICAgIGlmIChkYikge1xuICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgICAgIGRiLmNsb3NlKChlcnIpID0+IHtcbiAgICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCfinYwgRXJyb3IgY2xvc2luZyBkYXRhYmFzZTonLCBlcnIubWVzc2FnZSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCfinIUgRGF0YWJhc2UgY29ubmVjdGlvbiBjbG9zZWQnKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZGIgPSBudWxsO1xuICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICB9LFxuXG4gIC8vIFRyYW5zYWN0aW9uIGhlbHBlclxuICB0cmFuc2FjdGlvbjogYXN5bmMgKGNhbGxiYWNrKSA9PiB7XG4gICAgY29uc3QgZGIgPSBpbml0RGF0YWJhc2UoKTtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgZGF0YWJhc2UucXVlcnkoJ0JFR0lOIFRSQU5TQUNUSU9OJyk7XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjYWxsYmFjayhkYXRhYmFzZSk7XG4gICAgICBhd2FpdCBkYXRhYmFzZS5xdWVyeSgnQ09NTUlUJyk7XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBhd2FpdCBkYXRhYmFzZS5xdWVyeSgnUk9MTEJBQ0snKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBkYXRhYmFzZTtcbiJdLCJuYW1lcyI6WyJzcWxpdGUzIiwicmVxdWlyZSIsInZlcmJvc2UiLCJwYXRoIiwiZGJQYXRoIiwiam9pbiIsInByb2Nlc3MiLCJjd2QiLCJkYiIsImluaXREYXRhYmFzZSIsIkRhdGFiYXNlIiwiZXJyIiwiY29uc29sZSIsImVycm9yIiwibWVzc2FnZSIsImxvZyIsInJ1biIsImRhdGFiYXNlIiwiaW5pdCIsInF1ZXJ5Iiwic3FsIiwicGFyYW1zIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJ0cmltIiwidG9VcHBlckNhc2UiLCJzdGFydHNXaXRoIiwiYWxsIiwicm93cyIsInN1Y2Nlc3MiLCJyb3dDb3VudCIsImNoYW5nZXMiLCJsYXN0SUQiLCJpZCIsImdldCIsInJvdyIsImNsb3NlIiwidHJhbnNhY3Rpb24iLCJjYWxsYmFjayIsInJlc3VsdCIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./database/db.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/semver","vendor-chunks/bcryptjs","vendor-chunks/jsonwebtoken","vendor-chunks/lodash.includes","vendor-chunks/jws","vendor-chunks/lodash.once","vendor-chunks/jwa","vendor-chunks/lodash.isinteger","vendor-chunks/ecdsa-sig-formatter","vendor-chunks/lodash.isplainobject","vendor-chunks/ms","vendor-chunks/lodash.isstring","vendor-chunks/lodash.isnumber","vendor-chunks/lodash.isboolean","vendor-chunks/safe-buffer","vendor-chunks/buffer-equal-constant-time"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fthreads%2Froute&page=%2Fapi%2Fthreads%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fthreads%2Froute.ts&appDir=%2FUsers%2Friciboy%2FDesktop%2Fgaladarbinsskola%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Friciboy%2FDesktop%2Fgaladarbinsskola&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();